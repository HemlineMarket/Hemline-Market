<script type="module">
  import { createClient } from 'https://esm.sh/@supabase/supabase-js'

  const SUPABASE_URL = "https://kzqrfzvobxsbkppuexru.supabase.co"
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...." // your full key
  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

  document.getElementById('uploadBtn').addEventListener('click', async () => {
    const file = document.getElementById('fileInput').files[0]
    const status = document.getElementById('status')

    if (!file) {
      status.textContent = "⚠️ Please choose a file first."
      return
    }

    status.textContent = "⏳ Uploading..."

    const { data, error } = await supabase.storage
      .from('listing-images')
      .upload(`uploads/${Date.now()}-${file.name}`, file, { upsert: true })

    if (error) {
      status.textContent = "❌ Error: " + error.message
    } else {
      status.textContent = "✅ Uploaded: " + data.path
    }
  })
</script>
