<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Hemline — Cart</title>
<style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:24px;background:#fafafa;color:#0f172a}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:14px;box-shadow:0 2px 6px rgba(0,0,0,.05)}
.thumb{width:100%;height:170px;object-fit:cover;border-radius:8px;margin:0 0 10px;background:#f1f5f9}
.row{display:flex;justify-content:space-between;align-items:center;gap:8px}.title{font-weight:600}
.btn{border:1px solid #e5e7eb;background:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}
.cta{background:#0ea5e9;color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:600;cursor:pointer}
.cta:disabled{opacity:.5;cursor:not-allowed}.empty{border:2px dashed #e5e7eb;border-radius:12px;padding:24px;text-align:center;color:#475569}
.carousel{margin:26px 0 6px}.track{display:grid;grid-auto-flow:column;grid-auto-columns:minmax(220px,1fr);gap:12px;overflow:auto}
.badge{display:inline-block;background:#e2e8f0;border-radius:999px;padding:2px 8px;font-size:.75rem;margin-top:6px}
.overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(15,23,42,.55);backdrop-filter:blur(2px);z-index:50}
.panel{width:min(560px,92vw);background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.15)}
.step{display:flex;align-items:center;gap:10px;margin:10px 0}.dot{width:10px;height:10px;border-radius:50%;background:#cbd5e1}.step.done .dot{background:#0ea5e9}
.roll{height:16px;border-radius:999px;border:1px solid #cbd5e1;overflow:hidden;margin:12px 0 6px}.fill{height:100%;width:0%;background:repeating-linear-gradient(135deg,#0ea5e9 0 14px,#38bdf8 14px 28px);transition:width .5s}
</style></head><body>
<h1>Your Cart</h1>
<div id="cartGrid" class="grid"></div>
<div id="emptyMsg" class="empty" hidden>Cart is empty.</div>
<button id="checkoutBtn" class="cta" disabled>Checkout</button>

<div class="carousel"><h2>New Arrivals</h2><div id="arrivals" class="track"></div></div>

<div id="overlay" class="overlay"><div class="panel">
  <h3>Preparing Checkout</h3>
  <div class="step" id="s1"><span class="dot"></span><span>Securing cart</span></div>
  <div class="step" id="s2"><span class="dot"></span><span>Creating session</span></div>
  <div class="step" id="s3"><span class="dot"></span><span>Redirecting</span></div>
  <div class="roll"><div id="fill" class="fill"></div></div>
</div></div>

<script>
const KEY="hem_cart",PH="https://via.placeholder.com/600x400?text=Fabric";
const $=id=>document.getElementById(id),fmt=n=>`$${n.toFixed(2)}`;
const read=()=>{try{return JSON.parse(localStorage.getItem(KEY)||"[]")}catch(e){return[]}}, save=a=>localStorage.setItem(KEY,JSON.stringify(a||[]));
const proxy=u=>{try{const x=new URL(u);return "https://images.weserv.nl/?url=ssl:"+x.hostname+x.pathname+(x.search||"")+"&w=300&h=300&fit=cover"}catch(e){return PH}};
function render(){const cart=read(),grid=$("cartGrid"),empty=$("emptyMsg"),checkout=$("checkoutBtn");grid.innerHTML="";
  if(!cart.length){empty.hidden=false;checkout.disabled=true;return}
  empty.hidden=true;checkout.disabled=false;
  cart.forEach(it=>{const c=document.createElement("div");c.className="card";c.innerHTML=
    `<img class="thumb" src="${it.img||PH}"/><div class="title">${it.title}</div>
     <div class="row"><span>Qty</span><strong>${it.qty}</strong></div>
     <div class="row"><span>Price</span><strong>${fmt(it.price)}</strong></div>`;grid.appendChild(c);});
} render();
/* Checkout → save optimized images, then redirect (hardcoded) */
$("checkoutBtn").onclick=()=>{const overlay=$("overlay"),fill=$("fill"),s1=$("s1"),s2=$("s2"),s3=$("s3");
  const order=read(); if(!order.length)return;
  const optimized=order.map(it=>({...it,img:proxy(it.img||PH)}));
  sessionStorage.setItem("hem_order",JSON.stringify(optimized)); localStorage.removeItem(KEY);
  overlay.style.display="flex"; fill.style.width="0%"; [s1,s2,s3].forEach(x=>x.classList.remove("done"));
  const tick=(w,el,cb)=>setTimeout(()=>{fill.style.width=w;el.classList.add("done");cb&&cb()},450);
  tick("25%",s1,()=>tick("60%",s2,()=>tick("100%",s3,()=>{window.location.href="/success.html"})));
};
/* Arrivals with Add to Cart */
const arrivals=[{id:"mw-wool-crepe",title:"Merino Wool Crepe — Black",price:38.00,img:"https://images.unsplash.com/photo-1610030469983-98b5a19b7935?q=80&w=1200"},
{id:"silk-charmeuse",title:"Silk Charmeuse — Ivory",price:42.00,img:"https://images.unsplash.com/photo-1542060748-10c28b62716a?q=80&w=1200"},
{id:"cotton-sateen",title:"Cotton Sateen — Navy",price:18.50,img:"https://images.unsplash.com/photo-1490481651871-ab68de25d43d?q=80&w=1200"},
{id:"tropical-wool",title:"Tropical Wool — Charcoal",price:34.00,img:"https://images.unsplash.com/photo-1512436991641-6745cdb1723f?q=80&w=1200"}];
const track=$("arrivals");
arrivals.forEach(it=>{const el=document.createElement("div");el.className="card";el.innerHTML=
  `<img class="thumb" src="${it.img}"/><div class="title">${it.title}</div><div class="badge">$${it.price}/yd</div><button class="add">Add to Cart</button>`;
  el.querySelector(".add").onclick=()=>{let c=read();const f=c.find(x=>x.id===it.id);if(f)f.qty++;else c.push({...it,qty:1});save(c);render();};
  track.appendChild(el);
});
</script></body></html>
