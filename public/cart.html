<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Hemline — Cart</title>
  <style>
    :root { --ink:#0f172a; --bg:#fafafa; --card:#ffffff; --line:#e5e7eb; --accent:#0ea5e9; }
    body { font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; margin:24px; background:var(--bg); color:var(--ink); }
    .wrap { max-width:800px; margin:auto; }
    h1 { margin-top:0; }
    .item { background:var(--card); border:1px solid var(--line); border-radius:12px; padding:12px; margin-bottom:12px; display:flex; align-items:center; gap:12px; }
    .thumb { width:50px; height:50px; object-fit:cover; border-radius:8px; border:1px solid var(--line); }
    .title { flex-grow:1; }
    .btn { border:1px solid var(--line); border-radius:8px; padding:6px 12px; background:#fff; cursor:pointer; }
    .toolbar { display:flex; gap:10px; margin-top:20px; }
  </style>
</head>
<body>
  <div class="wrap">
    <a href="listings.html" style="color:var(--accent);text-decoration:none;display:inline-block;margin-bottom:20px;">← Back to Listings</a>
    <h1>Your Cart</h1>
    <div id="cart"></div>
    <div class="toolbar">
      <button id="checkout" class="btn">Checkout</button>
      <a href="orders.html" class="btn">View Orders</a>
    </div>
  </div>

  <script>
    const cartDiv = document.getElementById("cart");
    const checkoutBtn = document.getElementById("checkout");

    function loadCart() {
      const items = JSON.parse(localStorage.getItem("hem_cart") || "[]");
      cartDiv.innerHTML = "";
      if (items.length === 0) {
        cartDiv.innerHTML = "<p>No items in cart.</p>";
        checkoutBtn.disabled = true;
        return;
      }
      checkoutBtn.disabled = false;
      items.forEach((it, idx) => {
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <img src="${it.img}" class="thumb" onerror="this.src='https://via.placeholder.com/80?text=Fabric'"/>
          <div class="title">${it.title}</div>
          <div>$${it.price}</div>
        `;
        cartDiv.appendChild(div);
      });
    }

    checkoutBtn.onclick = () => {
      const items = JSON.parse(localStorage.getItem("hem_cart") || "[]");
      if (!items.length) return;
      const order = {
        id: Date.now().toString(),
        when: new Date().toISOString(),
        items: items,
        subtotal: items.reduce((a, c) => a + Number(c.price || 0), 0)
      };
      const prev = JSON.parse(localStorage.getItem("hem_orders") || "[]");
      localStorage.setItem("hem_orders", JSON.stringify([...prev, order]));
      localStorage.removeItem("hem_cart");
      window.location.href = "orders.html";
    };

    loadCart();
  </script>
</body>
</html>
