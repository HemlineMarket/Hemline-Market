<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Hemline Market ‚Äî Buy & Sell Fabric from Makers</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Buy and sell fabric from makers. Sustainable peer-to-peer fabric marketplace for sewists who care about slow fashion. Secure payments, prepaid shipping labels."/>
  <meta name="keywords" content="fabric marketplace, buy fabric, sell fabric, sustainable sewing, slow fashion, deadstock fabric, quilting cotton, silk, wool, linen"/>
  <meta name="author" content="Hemline Market"/>
  <meta name="robots" content="index, follow"/>
  <link rel="canonical" href="https://hemlinemarket.com/"/>

  <!-- Open Graph / Social Sharing -->
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://hemlinemarket.com/"/>
  <meta property="og:title" content="Hemline Market ‚Äî Buy & Sell Fabric from Makers"/>
  <meta property="og:description" content="Sustainable peer-to-peer fabric marketplace. Buy and sell fabric from fellow sewists. Secure payments, prepaid shipping."/>
  <meta property="og:image" content="https://hemlinemarket.com/images/og-image.png"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Hemline Market ‚Äî Buy & Sell Fabric from Makers"/>
  <meta name="twitter:description" content="Sustainable peer-to-peer fabric marketplace for sewists."/>
  <meta name="twitter:image" content="https://hemlinemarket.com/images/og-image.png"/>

  <!-- Theme Color -->
  <meta name="theme-color" content="#991b1b"/>

  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png"/>
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png"/>
  <link rel="apple-touch-icon" href="/images/logo-mark.svg"/>

  <!-- Shared styles -->
  <link rel="stylesheet" href="styles/hm-modern.css"/>
  <link rel="stylesheet" href="styles/hm-header.css"/>
  <link rel="stylesheet" href="styles/hm-typography.css"/>
  <link rel="stylesheet" href="styles/hm-footer.css"/>

  <style>
    :root{
      /* Brand palette */
      --hm-accent:#991b1b;        /* Hemline Bordeaux */
      --hm-accent-soft:#fef3f2;   /* Soft blush */
      --hm-border:#e5e7eb;
      --hm-muted:#6b7280;
      --hm-text:#111827;
      --hm-bg:#f4f4f7;

      --hm-eco:#246b4a;           /* Deep eco green (for future use) */
      --hm-eco-soft:#e4f5ec;
      --hm-sand:#fffbf7;          /* Warm sand card bg */

      --hm-bg-card:rgba(255,255,255,.96);
    }

    html,body{
      margin:0;
      max-width:100%;
      overflow-x:hidden;
      color:var(--hm-text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
    }

    /* background photo */
    body{
      background:
        url("images/homepage.jpeg") center/cover fixed no-repeat,
        var(--hm-bg);
    }

    main img, main svg, main canvas, main video{max-width:100%;height:auto;display:block}

    /* PAGE WRAP */
    main.hm-home{
      max-width:1200px;
      margin:18px auto 28px;
      padding:0 12px 24px;
    }

    /* HERO */
    .hero{
      background:rgba(255,255,255,.96);
      border-radius:18px;
      border:1px solid var(--hm-border);
      box-shadow:0 10px 30px rgba(15,23,42,.08);
      padding:16px 16px 16px;
      margin-bottom:16px;
    }
    .hero-header{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-start;
      justify-content:space-between;
      gap:8px 12px;
      margin-bottom:10px;
    }
    .hero-slogan{
      font-size:22px;
      font-weight:800;
      color:var(--hm-text);
      margin:0;
      max-width:720px;
    }

    /* SOFTER SEARCH BAR */
    .hero-search-row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
      padding:4px;
      border-radius:999px;
      border:1px solid #f3d6c9;
      background:var(--hm-accent-soft);
      box-shadow:0 3px 10px rgba(148,27,27,.05);
    }
    .hero-search-type-wrap{
      display:flex;
      align-items:center;
    }
    .hero-search-type{
      padding:9px 12px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fff;
      font-size:14px;
      font-weight:600;
      color:var(--hm-text);
      cursor:pointer;
      appearance:none;
      -webkit-appearance:none;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M3 5l3 3 3-3'/%3E%3C/svg%3E");
      background-repeat:no-repeat;
      background-position:right 10px center;
      padding-right:28px;
    }
    .hero-search-type:focus{
      outline:none;
      border-color:var(--hm-accent);
    }
    .hero-search-input-wrap{
      position:relative;
      flex:1;
      min-width:0;
    }
    .hero-search-icon{
      position:absolute;
      left:10px;
      top:50%;
      transform:translateY(-50%);
      font-size:14px;
      color:var(--hm-muted);
      pointer-events:none;
    }
    .hero-search-input{
      width:100%;
      padding:9px 12px;
      border-radius:999px;
      border:none;
      font-size:14px;
      background:transparent;
      color:var(--hm-text);
    }
    .hero-search-input::placeholder{
      color:#9ca3af;
    }
    .hero-search-input:focus{
      outline:none;
    }
    .hero-search-row:focus-within{
      box-shadow:0 0 0 2px rgba(153,27,27,.18);
    }
    .hero-search-btn{
      padding:9px 16px;
      border-radius:999px;
      border:none;
      background:var(--hm-accent);
      color:#fff;
      font-weight:700;
      font-size:14px;
      cursor:pointer;
      white-space:nowrap;
      box-shadow:0 4px 12px rgba(153,27,27,.25);
    }
    .hero-search-btn:hover{
      filter:brightness(1.02);
    }

    /* HOW IT WORKS CARD */
    .how-card{
      margin-top:14px;
      background:#fff7f3; /* soft peach */
      border-radius:14px;
      border:1px solid #f2c9b4;
      padding:14px 16px;
      font-size:13px;
      color:#374151;
      box-shadow:0 6px 16px rgba(15,23,42,.03);
    }

    .how-text{
      min-width:0;
    }
    .how-title{
      margin:0 0 8px;
      font-size:15px;
      font-weight:700;
      color:var(--hm-accent);
    }
    .how-card ul{
      margin:0 0 6px 0;
      padding:0;
      list-style:none;
    }
    .how-card li{
      margin-bottom:4px;
      position:relative;
      padding-left:18px;
    }
    .how-card li::before{
      content:"‚úì";
      position:absolute;
      left:0;
      top:0;
      font-size:11px;
      color:var(--hm-accent);
    }

    /* How It Works - Visual Steps WITH ARROWS */
    .how-steps{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      margin:12px 0;
      flex-wrap:wrap;
    }
    .how-step{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      gap:6px;
      padding:10px 12px;
      background:#fff;
      border-radius:10px;
      border:1px solid #fde2d9;
      min-width:80px;
      flex:1;
      max-width:140px;
    }
    .how-step-arrow{
      color:var(--hm-accent);
      font-size:24px;
      font-weight:bold;
      opacity:0.7;
      flex-shrink:0;
    }
    .how-step-icon{
      width:48px;
      height:48px;
    }
    .how-step-text{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .how-step-text strong{
      font-size:13px;
      color:var(--hm-accent);
    }
    .how-step-text span{
      font-size:11px;
      color:#6b7280;
    }
    
    /* Tablet: 2x2 grid */
    @media(max-width:700px){
      .how-steps{
        display:grid;
        grid-template-columns:1fr 1fr;
        gap:12px;
        justify-items:center;
        align-items:center;
      }
      .how-step{
        max-width:none;
        width:100%;
      }
      .how-step-arrow{
        display:none;
      }
    }
    
    /* Mobile: single column */
    @media(max-width:400px){
      .how-steps{
        display:grid;
        grid-template-columns:1fr 1fr;
        gap:10px;
      }
      .how-step{
        max-width:none;
        width:100%;
      }
      .how-step-arrow{
        display:none;
      }
    }

    /* grid so text + image share the same height */
    .how-inner{
      display:grid;
      grid-template-columns:minmax(0,2fr) minmax(0,1.3fr);
      align-items:stretch;
      gap:16px;
    }

    .how-text{
      min-width:0;
    }

    .how-image{
      border-radius:12px;
      overflow:hidden;
      background:#f3f4f6;
      box-shadow:0 6px 16px rgba(15,23,42,.08);
      height:100%;
      max-height:180px;
    }
    .how-image img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    @media(max-width:800px){
      .how-inner{
        grid-template-columns:1fr;
      }
      .how-image{
        max-height:240px;
      }
    }

    /* ABOUT HEMLINE MARKET CARD */
    .about-card{
      margin-top:14px;
      background:var(--hm-sand); /* warm sand */
      border-radius:14px;
      border:1px solid #f3e2c8;
      padding:16px;
      font-size:13px;
      color:#374151;
      line-height:1.55;
      box-shadow:0 6px 16px rgba(15,23,42,.03);
    }
    .about-card-inner{
      max-width:100%;
    }
    .about-header{
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:14px;
    }
    .about-title{
      margin:0;
      font-size:16px;
      font-weight:700;
      color:var(--hm-accent);
    }
    .about-cta-btn{
      text-decoration:none;
      font-size:13px;
      font-weight:700;
      padding:10px 20px;
      border-radius:999px;
      background:var(--hm-accent);
      color:#fff;
      border:none;
      transition:all .15s;
      box-shadow:0 4px 12px rgba(153,27,27,.25);
    }
    .about-cta-btn:hover{
      filter:brightness(1.1);
      transform:translateY(-1px);
    }
    
    /* Feature cards grid */
    .about-features{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px;
      margin-bottom:14px;
    }
    .about-feature{
      background:#fff;
      border-radius:12px;
      padding:14px;
      border:1px solid #f3e2c8;
      transition:all .2s;
      cursor:default;
    }
    .about-feature:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 20px rgba(153,27,27,.1);
      border-color:var(--hm-accent);
    }
    .about-feature-icon{
      font-size:24px;
      margin-bottom:8px;
    }
    .about-feature-title{
      font-weight:700;
      color:var(--hm-text);
      margin-bottom:4px;
      font-size:13px;
    }
    .about-feature-text{
      font-size:12px;
      color:#6b7280;
      line-height:1.4;
    }
    @media(max-width:700px){
      .about-features{
        grid-template-columns:1fr;
      }
    }
    
    /* Early supporter banner */
    .about-banner{
      background:linear-gradient(135deg,#fef3f2,#fff7ed);
      border:1px solid #fecaca;
      border-radius:10px;
      padding:12px 14px;
      display:flex;
      align-items:center;
      gap:10px;
      font-size:13px;
    }
    .about-banner-icon{
      font-size:20px;
      flex-shrink:0;
    }
    .about-banner-text{
      color:#374151;
    }
    .about-banner-text strong{
      color:var(--hm-accent);
    }

    .about-link{
      color:var(--hm-accent);
      font-weight:600;
      text-decoration:none;
    }
    .about-link:hover{
      text-decoration:underline;
    }
    
    .about-note{
      font-size:13px;
      color:#4b5563;
      margin:0 0 14px;
      line-height:1.5;
    }

    /* Trust badges */
    .trust-badges{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin:12px 0 6px;
    }
    .trust-badge{
      display:flex;
      align-items:center;
      gap:6px;
      padding:6px 12px;
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:8px;
      font-size:12px;
      font-weight:500;
      color:#374151;
    }
    .trust-icon{
      font-size:14px;
    }

    @media(max-width:640px){
      .about-cta-row{
        flex-direction:column;
        align-items:flex-start;
      }
    }

    /* THREADTALK PROMO ‚Äì burgundy */
    .threadtalk-promo{
      margin-top:12px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(153,27,27,.45);
      background:linear-gradient(120deg,#3b1010,#991b1b);
      color:#fef9f5;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap:10px 14px;
    }
    .tt-promo-main{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }
    .tt-promo-eyebrow{
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      opacity:.9;
    }
    .tt-promo-title{
      font-size:16px;
      font-weight:700;
      white-space:nowrap;
    }
    .tt-promo-sub{
      font-size:13px;
      opacity:.95;
      margin:0;
    }

    .tt-promo-tags{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:4px;
    }
    .tt-promo-tag{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(254,249,195,.25);
      background:rgba(15,23,42,.16);
      color:#fefce8;
      text-decoration:none;
      white-space:nowrap;
    }
    .tt-promo-tag:hover{
      background:rgba(15,23,42,.26);
    }

    .tt-promo-link{
      flex:0 0 auto;
      text-decoration:none;
      font-size:15px;
      font-weight:700;
      padding:10px 26px;
      border-radius:999px;
      border:1px solid #fef3c7;
      background:#fef3c7;
      color:#7f1d1d;
      white-space:nowrap;
      box-shadow:0 8px 18px rgba(15,23,42,.24);
    }
    .tt-promo-link:hover{
      background:#fde68a;
      border-color:#fde68a;
    }

    @media(max-width:640px){
      .threadtalk-promo{
        align-items:flex-start;
      }
      .tt-promo-main{
        width:100%;
      }
      .tt-promo-title{
        white-space:normal;
      }
      .tt-promo-tags{
        width:100%;
        margin-top:6px;
        display:grid;
        grid-template-columns:repeat(4,1fr);
        row-gap:6px;
        column-gap:6px;
      }
      .tt-promo-tag{
        font-size:9px;
        padding:6px 2px;
        text-align:center;
        white-space:normal;
        line-height:1.2;
        display:flex;
        align-items:center;
        justify-content:center;
      }
      .tt-promo-link{
        width:100%;
        text-align:center;
        justify-content:center;
        margin-top:10px;
      }
    }

    /* SECTION HEADER - New Arrivals */
    .section-header{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      margin:40px 0 28px;
      padding:24px 20px;
      background:linear-gradient(135deg, rgba(255,255,255,0.95), rgba(254,243,242,0.9));
      border-radius:16px;
      border:1px solid rgba(153,27,27,0.15);
      box-shadow:0 8px 24px rgba(153,27,27,0.08);
    }
    .section-header h2{
      margin:0 0 8px;
      font-size:36px;
      font-weight:700;
      color:var(--hm-accent);
      font-family: Georgia, 'Times New Roman', serif;
      letter-spacing: 2px;
      text-transform:uppercase;
      position:relative;
    }
    .section-header h2::after{
      content:"";
      display:block;
      width:60px;
      height:3px;
      background:var(--hm-accent);
      margin:12px auto 0;
      border-radius:2px;
    }
    .section-header span{
      font-size:14px;
      color:#6b7280;
      font-weight:500;
    }
    .section-header-subtitle{
      font-size:15px;
      color:#4b5563;
      margin-top:4px;
      max-width:500px;
    }

    /* NEW LISTINGS GRID */
    .home-listings-wrapper{
      background:transparent;
    }

    .home-listings-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:12px;
      align-items:stretch;
      grid-auto-rows:1fr;
    }
    @media(max-width:900px){
      .home-listings-grid{
        grid-template-columns:repeat(2,minmax(0,1fr));
      }
    }
    @media(max-width:560px){
      .home-listings-grid{
        grid-template-columns:repeat(2,minmax(0,1fr));
      }
    }
    @media(max-width:400px){
      .home-listings-grid{
        grid-template-columns:1fr;
      }
    }

    .home-empty{
      font-size:13px;
      color:#6b7280;
      padding:10px 2px;
    }

    /* LISTING CARDS */
    .home-listings-grid .listing-card{
      background:var(--hm-bg-card);
      border:1px solid var(--hm-border);
      border-radius:14px;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      height:100%;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .home-listings-grid .listing-card:hover{
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(153, 27, 27, 0.12), 0 4px 8px rgba(0,0,0,0.06);
      border-color: rgba(153, 27, 27, 0.2);
    }
    .home-listings-grid .listing-thumb-link{
      display:block;
      text-decoration:none;
      color:inherit;
      overflow:hidden;
    }
    .home-listings-grid .listing-thumb{
      aspect-ratio:1/1;
      background:linear-gradient(135deg,#fdf2f8,#f8fafc);
      display:grid;
      place-items:center;
      overflow:hidden;
      position:relative;
    }
    .home-listings-grid .listing-thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transition: transform 0.4s ease;
    }
    .home-listings-grid .listing-card:hover .listing-thumb img{
      transform: scale(1.05);
    }
    .home-listings-grid .listing-body{
      padding:10px 12px 12px;
      display:flex;
      flex-direction:column;
      gap:4px;
      flex:1;
    }
    .home-listings-grid .listing-title-row{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:6px;
    }
    .home-listings-grid .listing-title{
      font-weight:700;
      font-size:14px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      text-decoration:none;
      color:#111827;
      transition: color 0.2s;
    }
    .home-listings-grid .listing-card:hover .listing-title{
      color:#991b1b;
    }
    .home-listings-grid .listing-dept{
      font-size:10px;
      padding:3px 8px;
      border-radius:999px;
      background:linear-gradient(135deg, #fef3f2, #fce7f3);
      color:#991b1b;
      font-weight:600;
      flex:0 0 auto;
      white-space:nowrap;
    }
    .home-listings-grid .listing-yards{
      font-size:12px;
      color:#4b5563;
    }
    .home-listings-grid .listing-cta-row{
      margin-top:6px;
    }
    .home-listings-grid .listing-add-btn{
      width:100%;
      border-radius:10px;
      border:none;
      background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%);
      color:#fff;
      font-weight:600;
      font-size:12px;
      padding:10px 8px;
      cursor:pointer;
      white-space:normal;
      line-height:1.3;
      min-height:40px;
      text-align:center;
      box-shadow: 0 2px 8px rgba(153, 27, 27, 0.25);
      transition: all 0.2s ease;
    }
    .home-listings-grid .listing-add-btn:hover:not([disabled]){
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(153, 27, 27, 0.35);
    }
    .home-listings-grid .listing-add-btn[disabled]{
      opacity:.55;
      cursor:not-allowed;
      background: #9ca3af;
      box-shadow: none;
    }
    .home-listings-grid .listing-price-row{
      margin-top:6px;
      display:flex;
      align-items:center;
      gap:6px;
      font-size:12px;
      margin-top:auto;
    }
    .home-listings-grid .listing-price-main{
      font-weight:700;
      color:#111827;
    }
    .home-listings-grid .listing-price-orig{
      text-decoration:line-through;
      color:#9ca3af;
    }
    .home-listings-grid .listing-seller-row{
      margin-top:4px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      font-size:12px;
      color:#6b7280;
    }
    .home-listings-grid .listing-seller-name{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Skeleton Loading */
    .skeleton-grid{
      display:grid;
      grid-template-columns:repeat(4,minmax(180px,1fr));
      gap:14px;
    }
    .skeleton-card{
      background:#fff;
      border-radius:14px;
      border:1px solid var(--hm-border);
      overflow:hidden;
    }
    .skeleton-thumb{
      height:160px;
      background:linear-gradient(90deg,#f0f0f0 25%,#e8e8e8 50%,#f0f0f0 75%);
      background-size:200% 100%;
      animation:skeleton-shimmer 1.5s ease-in-out infinite;
    }
    .skeleton-body{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .skeleton-line{
      height:12px;
      border-radius:6px;
      background:linear-gradient(90deg,#f0f0f0 25%,#e8e8e8 50%,#f0f0f0 75%);
      background-size:200% 100%;
      animation:skeleton-shimmer 1.5s ease-in-out infinite;
    }
    .skeleton-line.w80{width:80%}
    .skeleton-line.w60{width:60%}
    .skeleton-line.w40{width:40%}
    @keyframes skeleton-shimmer{
      0%{background-position:200% 0}
      100%{background-position:-200% 0}
    }
    @media(max-width:900px){
      .skeleton-grid{grid-template-columns:repeat(2,1fr)}
    }
    @media(max-width:480px){
      .skeleton-grid{grid-template-columns:1fr}
    }

    /* Empty State */
    .home-empty{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
      padding:40px 20px;
      background:#fff;
      border-radius:14px;
      border:1px solid var(--hm-border);
    }
    .empty-illustration{
      margin-bottom:16px;
      opacity:0.9;
    }
    .empty-title{
      margin:0 0 8px;
      font-size:18px;
      font-weight:700;
      color:var(--hm-text);
    }
    .empty-text{
      margin:0 0 16px;
      font-size:14px;
      color:var(--hm-muted);
      max-width:300px;
    }
    .empty-cta{
      padding:10px 20px;
      background:var(--hm-accent);
      color:#fff;
      font-weight:600;
      font-size:14px;
      border-radius:8px;
      text-decoration:none;
    }
    .empty-cta:hover{
      filter:brightness(1.1);
    }
  @media(max-width:768px){body{background-position:20% center;}}
  </style>
</head>
<body>

  <noscript>
    <div style="padding:40px;text-align:center;background:#fef2f2;color:#991b1b;">
      <h2>JavaScript Required</h2>
      <p>Please enable JavaScript to use Hemline Market.</p>
    </div>
  </noscript>

  <div id="hm-shell-header"></div>

  <main class="hm-home" id="maincontent">
    <section class="hero" aria-label="Search fabrics">
      <div class="hero-header">
        <div>
          <div class="hero-slogan">
            Welcome to Hemline Market, where sewing meets sustainability.
          </div>
        </div>
      </div>

      <div class="how-card" aria-label="How Hemline Market works">
        <div class="how-inner">
          <div class="how-text">
            <div class="how-title">How Hemline Market works</div>
            
            <!-- Visual steps with icons AND ARROWS -->
            <div class="how-steps">
              <div class="how-step">
                <img src="images/icon-list.svg" alt="" class="how-step-icon" width="48" height="48" loading="lazy"/>
                <div class="how-step-text">
                  <strong>List</strong>
                  <span>Photograph & list your fabric</span>
                </div>
              </div>
              
              <span class="how-step-arrow" aria-hidden="true">‚Üí</span>
              
              <div class="how-step">
                <img src="images/icon-sell.svg" alt="" class="how-step-icon" width="48" height="48" loading="lazy"/>
                <div class="how-step-text">
                  <strong>Sell</strong>
                  <span>Buyer purchases securely</span>
                </div>
              </div>
              
              <span class="how-step-arrow" aria-hidden="true">‚Üí</span>
              
              <div class="how-step">
                <img src="images/icon-ship.svg" alt="" class="how-step-icon" width="48" height="48" loading="lazy"/>
                <div class="how-step-text">
                  <strong>Ship</strong>
                  <span>We provide prepaid labels</span>
                </div>
              </div>
              
              <span class="how-step-arrow" aria-hidden="true">‚Üí</span>
              
              <div class="how-step">
                <img src="images/icon-paid.svg" alt="" class="how-step-icon" width="48" height="48" loading="lazy"/>
                <div class="how-step-text">
                  <strong>Get Paid</strong>
                  <span>Funds transfer to your bank</span>
                </div>
              </div>
            </div>
            
            <!-- Trust badges -->
            <div class="trust-badges">
              <div class="trust-badge">
                <span class="trust-icon">üîí</span>
                <span>Secure checkout via Stripe</span>
              </div>
              <div class="trust-badge">
                <span class="trust-icon">üì¶</span>
                <span>Prepaid shipping labels</span>
              </div>
              <div class="trust-badge">
                <span class="trust-icon">‚úì</span>
                <span>Purchase protection</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <form id="homeSearchForm" class="hero-search-row" role="search">
        <div class="hero-search-type-wrap">
          <select id="searchType" class="hero-search-type">
            <option value="fabrics">Fabrics</option>
            <option value="sellers">Sellers</option>
          </select>
        </div>
        <div class="hero-search-input-wrap">
          <input
            id="homeSearchInput"
            class="hero-search-input"
            type="search"
            placeholder="Search fabrics by color, content, type, weight, yards, price, and more!"
          />
        </div>
        <button class="hero-search-btn" type="submit">
          Search
        </button>
      </form>

      <div class="about-card" aria-label="About Hemline Market">
        <div class="about-card-inner">
          <div class="about-header">
            <h2 class="about-title">About Hemline Market</h2>
            <a class="about-cta-btn" href="account.html">Create a free account ‚Üí</a>
          </div>
          
          <div class="about-features">
            <div class="about-feature">
              <div class="about-feature-icon">üå±</div>
              <div class="about-feature-title">Slow Fashion First</div>
              <div class="about-feature-text">Created for sewists who care about sustainability. Whether it's quilting cotton, silk charmeuse, or wool gabardine,  pass fabric along, reduce waste, spark creativity.</div>
            </div>
            <div class="about-feature">
              <div class="about-feature-icon">üõ°Ô∏è</div>
              <div class="about-feature-title">Safe & Secure</div>
              <div class="about-feature-text">Think of us as eBay or Poshmark, but for sewists, with prepaid shipping labels, secure Stripe payments, built-in purchase protection, and transparent pricing, what you see is for the full yardage, no swatch bait and switch.</div>
            </div>
            <div class="about-feature">
              <div class="about-feature-icon">üí¨</div>
              <div class="about-feature-title">Community Powered</div>
              <div class="about-feature-text"><a href="ThreadTalk.html" class="about-link">ThreadTalk</a>, our sewing forum, is a place to connect, share ideas, and grow together as makers.</div>
            </div>
          </div>
          
          <p class="about-note">This is the first version of Hemline Market, and we're just getting started. More tools and features are on the way, and we're genuinely excited to receive your <a href="contact.html" class="about-link">feedback</a> as we improve together.</p>
          
          <div class="about-banner" style="margin-top:12px;margin-bottom:8px;">
            <span class="about-banner-icon">üéÅ</span>
            <span class="about-banner-text"><strong>First 300 verified sellers</strong> lock in reduced selling fees for life. Early supporters deserve perks!</span>
          </div>
          
          <div class="about-banner" style="margin-bottom:8px;background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border:1px solid #f59e0b;">
            <span class="about-banner-icon">üöÄ</span>
            <span class="about-banner-text"><strong>Coming in Version 2:</strong> Marketplace for sewing patterns, handmade goods, sewing equipment, and multi-quantity listings.</span>
          </div>
          
          <div class="about-banner" style="margin-bottom:16px;background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border:1px solid #f59e0b;">
            <span class="about-banner-icon">‚ú®</span>
            <span class="about-banner-text"><strong>Coming in Version 3: <span style="color:#991b1b;">Custom Orders</span></strong> request custom pillows, costumes, garments, or embroidery. Post your project, and a vetted maker will handle the rest. Clear pricing, set timeline, delivered to your door.</span>
          </div>
        </div>
      </div>

      <div class="threadtalk-promo" aria-label="ThreadTalk community">
        <div class="tt-promo-main">
          <div class="tt-promo-eyebrow">NEW ¬∑ COMMUNITY</div>
          <div class="tt-promo-title">ThreadTalk: Hemline Market's sewing forum</div>
          <p class="tt-promo-sub">
            Ask for fabric advice, share works in progress, and get feedback from other sewists.
          </p>
          <div class="tt-promo-tags">
            <a class="tt-promo-tag" href="/showcase.html">Showcase</a>
            <a class="tt-promo-tag" href="/tailoring.html">Tailoring</a>
            <a class="tt-promo-tag" href="/stitch-school.html">Stitch School</a>
            <a class="tt-promo-tag" href="/fabric-sos.html">Fabric SOS</a>
            <a class="tt-promo-tag" href="/before-after.html">Before &amp; After</a>
            <a class="tt-promo-tag" href="/pattern-hacks.html">Pattern Hacks</a>
            <a class="tt-promo-tag" href="/stash-confessions.html">Stash Confessions</a>
            <a class="tt-promo-tag" href="/loose-threads.html">Loose Threads</a>
          </div>
        </div>
        <a class="tt-promo-link" href="ThreadTalk.html">Open ThreadTalk</a>
      </div>
    </section>

    <section class="home-listings-wrapper" aria-label="New listings">
      <div class="section-header">
        <h2>New Arrivals</h2>
        
      </div>
      <div id="homeListingsGrid" class="home-listings-grid"></div>
      
      <!-- Skeleton loading state -->
      <div id="homeListingsSkeleton" class="home-listings-grid skeleton-grid">
        <div class="skeleton-card"><div class="skeleton-thumb"></div><div class="skeleton-body"><div class="skeleton-line w80"></div><div class="skeleton-line w60"></div><div class="skeleton-line w40"></div></div></div>
        <div class="skeleton-card"><div class="skeleton-thumb"></div><div class="skeleton-body"><div class="skeleton-line w80"></div><div class="skeleton-line w60"></div><div class="skeleton-line w40"></div></div></div>
        <div class="skeleton-card"><div class="skeleton-thumb"></div><div class="skeleton-body"><div class="skeleton-line w80"></div><div class="skeleton-line w60"></div><div class="skeleton-line w40"></div></div></div>
        <div class="skeleton-card"><div class="skeleton-thumb"></div><div class="skeleton-body"><div class="skeleton-line w80"></div><div class="skeleton-line w60"></div><div class="skeleton-line w40"></div></div></div>
      </div>
      
      <!-- Empty state with illustration -->
      <div id="homeListingsEmpty" class="home-empty" style="display:none;">
        <img src="images/empty-state.svg" alt="" class="empty-illustration" width="200" height="160" loading="lazy"/>
        <h3 class="empty-title">No listings yet</h3>
        <p class="empty-text">Once sellers start listing fabric, new cards will appear here.</p>
        <a href="sell.html" class="empty-cta">Be the first to list fabric ‚Üí</a>
      </div>
      </div>
    </section>
  </main>

  <div id="hm-shell-footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="scripts/hm-shell.js"></script>

  <script>
    window.HM && window.HM.renderShell({ currentPage: "home" });
  </script>

  <script>
    const HM = window.HM || {};
    const supabaseClient = HM.supabase;

    if (!supabaseClient) {
      console.warn("[Home] Supabase client not found on window.HM.supabase; listings disabled for now.");
    }

    function moneyFromCents(c){
      if(c == null) return "";
      const v = Number(c) / 100;
      return v.toLocaleString("en-US",{
        style:"currency",
        currency:"USD",
        minimumFractionDigits:2,
        maximumFractionDigits:2
      });
    }

    // Optimize Supabase images with resize transform for faster loading
    // NOTE: Disabled for now - Supabase image transforms may not be enabled
    function thumbUrl(url, width = 400) {
      if (!url) return "";
      // Return original URL for now
      return url;
      
      // To enable optimization later, uncomment below:
      // if (url.includes("supabase.co/storage/v1/object/public/")) {
      //   return url.replace(
      //     "/storage/v1/object/public/",
      //     `/storage/v1/render/image/public/`
      //   ) + `?width=${width}&quality=75`;
      // }
      // return url;
    }

    function computeYards(row){
      const y1 = row.yards_available;
      const y2 = row.yardage;
      const raw = (y1 != null ? Number(y1) : (y2 != null ? Number(y2) : null));
      if(!Number.isFinite(raw) || raw <= 0) return null;
      return raw;
    }

    async function fetchProfilesForListings(listings){
      const map = {};
      const ids = Array.from(new Set(
        (listings || [])
          .map(l => l.seller_id)
          .filter(Boolean)
      ));
      if(!ids.length) return map;

      try{
        const { data, error } = await supabaseClient
          .from("profiles")
          .select("id, display_name, store_name, first_name, last_name")
          .in("id", ids);

        if(error){
          console.error("Profile fetch error", error);
          return map;
        }
        (data || []).forEach(p=>{
          map[p.id] = p;
        });
      }catch(e){
        console.error("Profile fetch exception", e);
      }
      return map;
    }

    async function loadHomeListings(){
      const grid  = document.getElementById("homeListingsGrid");
      const empty = document.getElementById("homeListingsEmpty");
      const count = document.getElementById("homeListingsCount");
      const skeleton = document.getElementById("homeListingsSkeleton");

      if(grid) grid.innerHTML = "";
      if(empty) empty.style.display = "none";
      if(skeleton) skeleton.style.display = "grid";
      if(count) count.textContent = "Loading‚Ä¶";

      if (!supabaseClient) {
        if (count) count.textContent = "Listings coming soon";
        return;
      }

      let listings = [];
      try{
        // Fetch all listings, filter client-side (same approach as atelier.html)
        const { data, error } = await supabaseClient
          .from("listings")
          .select("*")
          .order("published_at", { ascending:false, nullsFirst: false })
          .limit(50);

        if(error){
          console.error("Home listings error", error);
          if(count) count.textContent = "Error loading listings";
          return;
        }
        
        const now = new Date();
        // Client-side filtering: is_published true, status active (not sold), has yards available
        listings = (data || []).filter(l => {
          if(l.is_published !== true) return false;
          const status = (l.status || "active").toLowerCase();
          // Hide sold listings
          if(status === "sold") return false;
          if(status !== "active") return false;
          // Hide listings with no yards available
          if(l.yards_available != null && l.yards_available <= 0) return false;
          if(l.published_at && new Date(l.published_at) > now) return false;
          return true;
        }).slice(0, 12); // Limit to 12 for homepage
      }catch(e){
        console.error("Home listings exception", e);
        if(count) count.textContent = "Error loading listings";
        return;
      }

      const total = listings.length;
      
      // Hide skeleton
      if(skeleton) skeleton.style.display = "none";
      
      if(count){
        count.textContent = total === 1 ? "1 listing" : total + " listings";
      }

      if(!total){
        if(empty) empty.style.display = "flex";
        return;
      }

      const profileMap = await fetchProfilesForListings(listings);

      listings.forEach(item=>{
        const yards = computeYards(item);
        const priceCents = item.price_cents != null ? Number(item.price_cents) : null;
        const origPriceCents = item.orig_price_cents != null ? Number(item.orig_price_cents) : null;

        const perYdMoney = priceCents != null ? moneyFromCents(priceCents) : "";
        const origPerMoney = origPriceCents != null ? moneyFromCents(origPriceCents) : "";

        const totalCents = (priceCents != null && yards != null) ? priceCents * yards : null;
        const totalMoney = totalCents != null ? moneyFromCents(totalCents) : "";

        const status = (item.status || "active").toLowerCase();
        const isSold = status === "sold" || (yards != null && yards <= 0) || item.yards_available === 0;
        const canBuy = !isSold && priceCents != null && yards != null && yards > 0;

        const card = document.createElement("article");
        card.className = "listing-card";

        const href = "listing.html?id=" + encodeURIComponent(item.id);
        const safeTitle = item.title || "Untitled listing";
        const safeAlt = safeTitle.replace(/"/g,"&quot;");

        const prof = profileMap[item.seller_id] || {};
        const displayName = (prof.first_name && prof.last_name)
          ? (prof.first_name + " " + prof.last_name)
          : (prof.display_name || "");
        const storeName = prof.storeName || prof.store_name || displayName || "Hemline Market seller";

        card.innerHTML = `
          <a class="listing-thumb-link" href="${href}">
            <div class="listing-thumb" aria-hidden="true">
              ${item.image_url_1 ? `<img src="${thumbUrl(item.image_url_1, 400)}" alt="${safeAlt}" loading="lazy">` : ""}
            </div>
          </a>
          <div class="listing-body">
            <div class="listing-title-row">
              <a class="listing-title" href="${href}">${safeTitle}</a>
              ${item.dept ? `<span class="listing-dept">${item.dept}</span>` : ""}
            </div>
            ${yards != null ? `<div class="listing-yards">${yards} yards</div>` : ""}
            <div class="listing-cta-row">
              <button
                type="button"
                class="listing-add-btn add-to-cart"
                data-add-to-cart="1"
                data-listing-id="${String(item.id)}"
                data-name="${String(safeTitle).replace(/"/g,'&quot;')}"
                data-photo="${String(item.image_url_1 || "")}"
                data-yards="${yards != null ? String(yards) : "0"}"
                data-price="${priceCents != null ? (priceCents/100).toFixed(2) : "0"}"
                data-amount="${priceCents != null ? String(priceCents) : "0"}"
                data-seller-id="${String(item.seller_id || "")}"
                data-seller-name="${String(storeName).replace(/"/g,'&quot;')}"
              >
                ${
                  canBuy && totalMoney && yards
                    ? `Add to Cart ‚Äî ${totalMoney} for ${yards} yards`
                    : (isSold ? "Sold out" : "Add to Cart")
                }
              </button>
            </div>
            <div class="listing-price-row">
              ${
                perYdMoney
                  ? `<span class="listing-price-main">${perYdMoney}/yard</span>`
                  : `<span class="listing-price-main">Price coming soon</span>`
              }
              ${
                origPerMoney
                  ? `<span class="listing-price-orig">${origPerMoney}/yard</span>`
                  : ""
              }
            </div>
            <div class="listing-seller-row">
              <span class="listing-seller-name">${storeName}</span>
            </div>
          </div>
        `;

        const btn = card.querySelector(".listing-add-btn");
        if(btn){
          if(!canBuy){
            btn.disabled = true;
            btn.textContent = isSold ? "Sold out" : "Unavailable";
          }
        }

        grid.appendChild(card);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("homeSearchForm");
      const input = document.getElementById("homeSearchInput");
      const searchType = document.getElementById("searchType");

      // Update placeholder based on search type
      if(searchType && input){
        searchType.addEventListener("change", () => {
          if(searchType.value === "sellers"){
            input.placeholder = "Search by store name or seller name...";
          } else {
            input.placeholder = "Search fabrics by color, content, type, weight, yards, price, and more!";
          }
        });
      }

      if(form && input){
        form.addEventListener("submit", (e) => {
          e.preventDefault();
          const q = input.value.trim();
          const type = searchType?.value || "fabrics";

          const params = new URLSearchParams();
          if(q) params.set("q", q);
          
          // If searching sellers, go to browse with ateliers mode
          if(type === "sellers"){
            params.set("mode", "ateliers");
          }

          const qs = params.toString();
          const url = "browse.html" + (qs ? "?" + qs : "");
          window.location.href = url;
        });
      }

      loadHomeListings();
    });
  </script>

  <!-- add-to-cart.js NOT included here - index.html has its own handler below -->

  <script>
    // Index-only: make Add to Cart work even for dynamically created cards
    (function(){
      function toNum(x){ const n = Number(x); return Number.isFinite(n) ? n : 0; }

      function addToCartFromDataset(ds){
        // supports both dataset variants: data-* OR your older btn.dataset.*
        const id = ds.listingId || ds.id || "";
        if(!id) return false;

        const yards = toNum(ds.yards);
        const price = toNum(ds.price); // dollars per yard
        const amount = toNum(ds.amount); // total cents if provided

        const item = {
          id: String(id),
          name: ds.name || "Listing",
          photo: ds.photo || "",
          yards: yards,
          qty: yards || 1,
          price: price || 0,
          amount: amount || 0,
          sellerId: ds.sellerId || "",
          sellerName: ds.sellerName || ""
        };

        // Try common cart APIs; fall back to localStorage
        try{
          if(window.HM && typeof window.HM.addToCart === "function"){
            window.HM.addToCart(item);
            return true;
          }
        }catch(e){}

        try{
          if(window.Cart && typeof window.Cart.add === "function"){
            window.Cart.add(item);
            return true;
          }
        }catch(e){}

        try{
          const key = "hm_cart";
          const existing = JSON.parse(localStorage.getItem(key) || "[]");
          const arr = Array.isArray(existing) ? existing : [];
          
          // Check for duplicate - fabric is sold as whole lot, no duplicates allowed
          const isDuplicate = arr.some(it => String(it.id) === String(item.id));
          if(isDuplicate){
            return "duplicate";
          }
          
          arr.push(item);
          localStorage.setItem(key, JSON.stringify(arr));
          window.dispatchEvent(new CustomEvent("hm:cart-updated", { detail: { source: "index" } }));
          return true;
        }catch(e){
          console.error("[index] cart fallback failed", e);
          return false;
        }
      }

      document.addEventListener("click", (e) => {
        const btn = e.target.closest("[data-add-to-cart], .add-to-cart, .listing-add-btn");
        if(!btn) return;

        // Only handle buttons on index that represent add-to-cart
        const isAdd = btn.matches("[data-add-to-cart]") || btn.classList.contains("add-to-cart") || btn.classList.contains("listing-add-btn");
        if(!isAdd) return;

        // Prevent any link/button default that might interfere
        e.preventDefault();
        e.stopPropagation();

        // If disabled, do nothing
        if(btn.disabled) return;

        const result = addToCartFromDataset(btn.dataset || {});
        if(result === "duplicate"){
          const old = btn.textContent;
          btn.textContent = "Already in cart";
          btn.disabled = true;
          setTimeout(() => {
            btn.disabled = false;
            btn.textContent = old;
          }, 1500);
        } else if(result === true){
          const old = btn.textContent;
          btn.textContent = "Added ‚úì";
          btn.disabled = true;
          setTimeout(() => {
            btn.disabled = false;
            btn.textContent = old;
          }, 900);
        } else {
          alert("Could not add to cart. Please refresh and try again.");
        }
      }, true);
    })();
  </script>

  <!-- Accessibility improvements -->
  <script src="scripts/accessibility.js"></script>
  
  <!-- Structured data for SEO -->
  <script src="scripts/structured-data.js"></script>
  
  <!-- Service worker for offline support -->
  <script src="scripts/sw-register.js"></script>

</body>
</html>
