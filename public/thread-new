<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Start a Post — ThreadTalk</title>
<link rel="icon" href="/favicon.ico"/>

<!-- Shared site styles -->
<link rel="stylesheet" href="styles/hm-modern.css"/>
<link rel="stylesheet" href="styles/hem-header.css"/>
<link rel="stylesheet" href="styles/hm-typography.css"/>
<link rel="stylesheet" href="styles/hm-footer.css"/>

<style>
  :root{
    --brand:#991b1b; --ink:#3f2f2a; --muted:#7a6e68; --border:#e8e0d9; --card:#fff; --bg:#fdfbf9;
  }
  body{background:linear-gradient(180deg,var(--bg) 0%, #fff 100%); color:var(--ink);}
  .wrap{max-width:1100px;margin:22px auto 44px;padding:0 16px}

  .page-head{
    border:1px solid var(--border);border-radius:18px;padding:20px 18px;margin-bottom:16px;background:#fff;
    display:flex;align-items:center;justify-content:space-between;gap:12px
  }
  .page-head h1{font-family:ui-serif,"Cormorant Garamond",serif;font-size:28px;margin:0}
  .crumbs a{color:var(--brand);text-decoration:none}

  .editor{
    display:grid;grid-template-columns:1fr 420px;gap:18px
  }
  @media (max-width:980px){ .editor{grid-template-columns:1fr} }

  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:0 10px 16px rgba(50,38,31,.06)}
  .field{margin:10px 0 14px}
  .field label{display:block;font-weight:700;margin-bottom:6px}
  .field input[type="text"], .field select, .field textarea{
    width:100%;border:1px solid var(--border);border-radius:12px;padding:10px 12px;font:inherit;background:#fff
  }
  textarea{min-height:160px;resize:vertical;line-height:1.5}
  .hint{font-size:12px;color:var(--muted);margin-top:4px}
  .row{display:flex;gap:10px;flex-wrap:wrap}

  .drop{
    border:1px dashed #d7ccc5;border-radius:12px;padding:14px;text-align:center;background:#fffdfb
  }
  .drop input{display:none}
  .thumbs{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .thumbs img{width:96px;height:96px;object-fit:cover;border-radius:10px;border:1px solid var(--border)}

  .actions{display:flex;gap:10px;align-items:center;margin-top:10px}
  .btn-primary{background:#2d2d2d;color:#fff;border:1px solid #2d2d2d;border-radius:12px;padding:10px 14px;font-weight:700}
  .btn-ghost{background:#fff;border:1px solid var(--border);border-radius:12px;padding:10px 14px}
  .btn-primary[disabled]{opacity:.5;cursor:not-allowed}

  /* Preview */
  .preview .title{font-weight:800;margin:4px 0 6px}
  .preview .meta{font-size:13px;color:var(--muted);margin-bottom:6px}
  .chips{display:flex;gap:6px;flex-wrap:wrap}
  .chip{border:1px solid var(--border);border-radius:999px;padding:6px 8px;font-size:12px;background:#fff}
  .banner{display:none;margin-bottom:12px;border-left:4px solid var(--brand);padding:10px 12px;background:#fff7f6;border-radius:8px}
  .ok{display:inline-block;margin-left:6px;color:#2e7d32}
</style>
</head>
<body>

<!-- HEADER (shared) -->
<header class="hm-header" role="banner">
  <div class="wrap-1200" style="max-width:1200px;margin:0 auto;padding:0 16px;display:flex;align-items:center;justify-content:space-between;">
    <div style="display:flex;align-items:center;gap:10px">
      <button class="hamburger" id="openMenu" aria-label="Open menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" style="width:22px;height:22px;stroke-width:2">
          <line x1="4" y1="6"  x2="20" y2="6"></line><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
      <a class="hm-brand" href="index.html">Hemline Market</a>
    </div>
    <a class="hm-btn-primary" href="ThreadTalk.html" style="text-decoration:none">← Back to ThreadTalk</a>
  </div>
</header>

<div id="sheetOverlay" aria-hidden="true"></div>
<aside class="sheet" id="menuSheet" aria-hidden="true" role="dialog" aria-modal="true">
  <header style="display:flex;align-items:center;justify-content:space-between;padding:10px;border-bottom:1px solid var(--border)">
    <strong>Menu</strong>
    <button class="close" id="closeMenu" aria-label="Close menu" style="display:inline-grid;place-items:center;width:30px;height:30px;border:1px solid var(--border);border-radius:8px;background:#fff">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
    </button>
  </header>
  <nav style="display:grid;padding:10px">
    <a href="ThreadTalk.html" class="nav">ThreadTalk</a>
    <a href="browse.html" class="nav">Browse & Search</a>
    <a href="atelier.html" class="nav">My Atelier</a>
    <a href="seller/index.html?list=new" class="nav">Sell Fabric</a>
    <a href="contact.html" class="nav">Contact</a>
  </nav>
</aside>

<main class="wrap" role="main">
  <div class="page-head card">
    <h1>Start a Post</h1>
    <div class="crumbs"><a href="ThreadTalk.html">ThreadTalk</a> / Start a Post</div>
  </div>

  <div id="savedBanner" class="banner">Saved as draft<span class="ok">✓</span></div>

  <div class="editor">
    <!-- Left: form -->
    <form id="postForm" class="card" novalidate>
      <div class="field">
        <label for="title">Title</label>
        <input id="title" name="title" type="text" placeholder="What do you want to ask or share?" required maxlength="120"/>
        <div class="hint"><span id="tCount">0</span>/120</div>
      </div>

      <div class="row">
        <div class="field" style="flex:1 1 260px">
          <label for="topic">Topic</label>
          <select id="topic" name="topic" required>
            <option value="">Choose…</option>
            <option>Showcase</option>
            <option>Tailoring</option>
            <option>Stitch School</option>
            <option>Fabric SOS</option>
            <option>Before & After</option>
            <option>Pattern Hacks</option>
            <option>Stash Confessions</option>
            <option>Loose Threads</option>
          </select>
        </div>
        <div class="field" style="flex:1 1 260px">
          <label for="tags">Tags (comma-separated)</label>
          <input id="tags" name="tags" type="text" placeholder="#zipper, #woolcrepe"/>
        </div>
      </div>

      <div class="field">
        <label for="body">Details</label>
        <textarea id="body" name="body" placeholder="Add photos, measurements, what you tried, links, etc." required></textarea>
        <div class="hint">Be respectful. No spam. No sales—use Sell Fabric for listings.</div>
      </div>

      <div class="field">
        <label>Photos</label>
        <label class="drop" for="photos">
          <strong>Click to upload</strong> or drag files here (JPG/PNG, up to 6)
          <input id="photos" type="file" accept="image/*" multiple/>
        </label>
        <div id="thumbs" class="thumbs" aria-live="polite"></div>
      </div>

      <div class="actions">
        <button type="button" class="btn-ghost" id="saveDraft">Save Draft</button>
        <button type="submit" class="btn-primary" id="submitBtn" disabled>Post to ThreadTalk</button>
      </div>
    </form>

    <!-- Right: live preview -->
    <aside class="card preview" aria-label="Live preview">
      <div class="meta">Preview • appears in “Latest Threads”</div>
      <div class="title" id="pvTitle">Title goes here</div>
      <div class="meta" id="pvTopic">[Topic]</div>
      <div id="pvImgs" class="thumbs"></div>
      <div id="pvBody" style="white-space:pre-wrap;color:#5e544d;margin-top:6px">Start typing to see your post…</div>
      <div id="pvChips" class="chips" style="margin-top:8px"></div>
    </aside>
  </div>
</main>

<footer class="hm-footer" role="contentinfo">
  <div class="wrap-1200" style="display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;padding:12px 16px">
    <div class="copy">© 2025 Hemline Market</div>
    <nav class="footer-links" aria-label="Footer">
      <a href="about.html">About</a>
      <a href="faq.html">FAQ</a>
      <a href="rules.html">Rules</a>
      <a href="contact.html">Contact</a>
      <a href="terms.html">Terms</a>
      <a href="privacy.html">Privacy</a>
    </nav>
  </div>
</footer>

<script>
(function(){
  // Hamburger (same logic as ThreadTalk)
  var sheet=document.getElementById('menuSheet');
  var overlay=document.getElementById('sheetOverlay');
  var openBtn=document.getElementById('openMenu');
  var closeBtn=document.getElementById('closeMenu');
  function openSheet(){sheet.classList.add('open');sheet.setAttribute('aria-hidden','false');overlay.classList.add('show');document.body.style.overflow='hidden';}
  function closeSheet(){sheet.classList.remove('open');sheet.setAttribute('aria-hidden','true');overlay.classList.remove('show');document.body.style.overflow='';}
  if(openBtn){openBtn.addEventListener('click',function(e){e.preventDefault();openSheet();});}
  if(closeBtn){closeBtn.addEventListener('click',function(e){e.preventDefault();closeSheet();});}
  overlay.addEventListener('click',closeSheet);
  document.addEventListener('keydown',function(e){if(e.key==='Escape')closeSheet();});

  // Live preview + validation
  var f=document.getElementById('postForm');
  var title=document.getElementById('title');
  var tCount=document.getElementById('tCount');
  var topic=document.getElementById('topic');
  var body=document.getElementById('body');
  var tags=document.getElementById('tags');
  var submitBtn=document.getElementById('submitBtn');

  var pvTitle=document.getElementById('pvTitle');
  var pvTopic=document.getElementById('pvTopic');
  var pvBody=document.getElementById('pvBody');
  var pvChips=document.getElementById('pvChips');

  function update(){
    tCount.textContent=title.value.length;
    pvTitle.textContent=title.value || 'Title goes here';
    pvTopic.textContent=topic.value ? '['+topic.value+']' : '[Topic]';
    pvBody.textContent=body.value || 'Start typing to see your post…';
    pvChips.innerHTML='';
    if(tags.value.trim()){
      tags.value.split(',').map(s=>s.trim()).filter(Boolean).forEach(function(t){
        var span=document.createElement('span'); span.className='chip'; span.textContent=t.startsWith('#')?t:'#'+t; pvChips.appendChild(span);
      });
    }
    submitBtn.disabled = !(title.value.trim() && topic.value && body.value.trim());
  }
  ['input','change','keyup'].forEach(ev=>{
    title.addEventListener(ev,update); topic.addEventListener(ev,update);
    body.addEventListener(ev,update); tags.addEventListener(ev,update);
  }); update();

  // Photos -> thumbnails + preview
  var photos=document.getElementById('photos');
  var thumbs=document.getElementById('thumbs');
  var pvImgs=document.getElementById('pvImgs');
  photos.addEventListener('change',function(){
    thumbs.innerHTML=''; pvImgs.innerHTML='';
    Array.from(photos.files).slice(0,6).forEach(function(file){
      var url=URL.createObjectURL(file);
      var img=document.createElement('img'); img.src=url; img.alt='upload';
      var img2=img.cloneNode(); thumbs.appendChild(img); pvImgs.appendChild(img2);
    });
  });

  // Save draft (localStorage)
  var saved=document.getElementById('savedBanner');
  document.getElementById('saveDraft').addEventListener('click',function(){
    var draft={title:title.value,topic:topic.value,body:body.value,tags:tags.value};
    try{ localStorage.setItem('tt_draft', JSON.stringify(draft)); saved.style.display='block'; setTimeout(()=>saved.style.display='none',1800);}catch(e){}
  });
  // Load draft if any
  try{
    var d=localStorage.getItem('tt_draft'); if(d){
      var draft=JSON.parse(d); if(draft){
        title.value=draft.title||''; topic.value=draft.topic||''; body.value=draft.body||''; tags.value=draft.tags||'';
        update();
      }
    }
  }catch(e){}

  // Submit (demo): store to localStorage and go back to feed
  f.addEventListener('submit',function(e){
    e.preventDefault();
    var post={
      user:'YY', name:'You', topic:topic.value, title:title.value, body:body.value,
      tags: (tags.value||'').split(',').map(s=>s.trim()).filter(Boolean)
    };
    try{ localStorage.setItem('tt_last_post', JSON.stringify(post)); }catch(e){}
    window.location.href='ThreadTalk.html#feed';
  });
})();
</script>
</body>
</html>
