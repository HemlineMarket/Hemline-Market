<!-- File: notifications.html -->
<!doctype html>
<html lang="en">
<head>
  <!-- MOBILE HOTFIX -->
  <style id="hm-mobile-hotfix">
    html, body { max-width:100%; overflow-x:hidden; }
    .rail, .chiprail { overflow-x:auto; -webkit-overflow-scrolling: touch; }
    .grid, .section, .toolbar, .header, .tabbar { max-width:100%; }
    img, video, canvas, svg { max-width:100%; height:auto; }
    [style*="width:1200px"], [style*="max-width:1200px"] { width:auto !important; max-width:100% !important; }
  </style>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Notifications — Hemline Market</title>

  <!-- Shared site styles -->
  <link rel="stylesheet" href="styles/hm-modern.css"/>
  <link rel="stylesheet" href="styles/hem-header.css"/>
  <link rel="stylesheet" href="styles/hm-typography.css"/>
  <link rel="stylesheet" href="styles/hm-footer.css"/>

  <style>
    :root{
      --hm-accent:#991b1b;
      --hm-text:#111827;
      --hm-muted:#6b7280;
      --hm-border:#e5e7eb;
      --hm-bg:#fafafa;
    }
    body{
      margin:0;
      background:var(--hm-bg);
      color:var(--hm-text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
    }

    .wrap{max-width:1200px;margin:12px auto;padding:0 12px}

    /* Header */
    .hm-header{min-height:56px;background:#fff;border-bottom:1px solid var(--hm-border)}
    .hm-header .wrap{display:flex;align-items:center;justify-content:space-between}
    .hm-brand{font-size:24px;font-weight:800;color:#991b1b;text-decoration:none}
    .hamburger{
      display:inline-grid;
      place-items:center;
      width:36px;
      height:36px;
      border:1px solid var(--hm-border);
      border-radius:10px;
      background:#fff;
      color:#374151;
      cursor:pointer;
    }
    .hamburger svg{width:22px;height:22px;stroke-width:2}
    .right{display:flex;align-items:center;gap:14px}
    .hm-icon{color:#444;display:inline-grid;place-items:center}
    .hm-icon svg{width:26px;height:26px;stroke-width:2}
    .hm-avatar{
      width:28px;height:28px;
      border-radius:50%;
      border:1px solid var(--hm-border);
      background:#fff;
      color:#334155;
      display:inline-grid;
      place-items:center;
      font-weight:700;
      font-size:12px;
      text-decoration:none;
      background-size:cover;
      background-position:center;
    }
    .hm-btn-primary{
      background:var(--hm-accent);
      color:#fff;
      border:1px solid var(--hm-accent);
      border-radius:999px;
      padding:10px 18px;
      font-weight:700;
      text-decoration:none;
      box-shadow:0 2px 8px rgba(153,27,27,.25);
    }

    /* Left sheet nav */
    .sheet{
      position:fixed;
      inset:0 auto 0 0;
      width:min(84vw,340px);
      background:#fff;
      border-right:1px solid var(--hm-border);
      transform:translateX(-100%);
      transition:transform .25s ease;
      z-index:100;
      display:flex;
      flex-direction:column;
    }
    .sheet.open{transform:translateX(0)}
    .sheet header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:10px;
      border-bottom:1px solid var(--hm-border);
    }
    .sheet nav{display:grid;padding:10px}
    .sheet nav a{
      padding:10px;
      border:1px solid var(--hm-border);
      border-radius:10px;
      text-decoration:none;
      color:#1f2937;
    }
    .sheet nav a + a{margin-top:8px}
    .sheet .close{
      display:inline-grid;
      place-items:center;
      width:30px;
      height:30px;
      border:1px solid var(--hm-border);
      border-radius:8px;
      background:#fff;
      color:#444;
      cursor:pointer;
    }

    /* Notifications */
    .pagehead{
      margin:8px 0 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .pagehead h1{margin:0;font-size:22px}
    .actions{display:flex;gap:8px}
    .btn{
      padding:8px 12px;
      border:1px solid var(--hm-border);
      border-radius:10px;
      background:#fff;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
    }
    .btn:disabled{opacity:.6;cursor:not-allowed}

    .notif-card{
      background:#fff;
      border:1px solid var(--hm-border);
      border-radius:12px;
      overflow:hidden;
    }
    .group{
      padding:10px 12px;
      border-bottom:1px solid var(--hm-border);
      background:#fafafa;
      font-weight:700;
      color:#374151;
      font-size:13px;
    }
    .list{display:grid}
    .item{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap:12px;
      align-items:center;
      padding:12px;
      border-bottom:1px solid var(--hm-border);
    }
    .item:last-child{border-bottom:0}
    .dot{
      width:10px;
      height:10px;
      border-radius:50%;
      background:var(--hm-accent);
      opacity:.95;
    }
    .item.read .dot{opacity:0}
    .title{font-weight:700;font-size:14px}
    .meta{color:var(--hm-muted);font-size:12px;margin-top:2px}
    .tag{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      font-size:11px;
      margin-top:4px;
      color:#4b5563;
      background:#f9fafb;
    }
    .link{
      color:#1f2937;
      text-decoration:none;
      border:1px solid var(--hm-border);
      border-radius:8px;
      padding:6px 10px;
      background:#fff;
      font-weight:700;
      font-size:13px;
      white-space:nowrap;
    }
    .empty{
      padding:14px;
      color:#6b7280;
      font-size:13px;
    }

    /* Footer */
    .hm-footer{
      background:#fff;
      border-top:1px solid var(--hm-border);
      margin-top:18px;
    }
    .hm-footer .footer-wrap{
      max-width:1200px;
      margin:0 auto;
      padding:12px 16px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      justify-content:space-between;
    }
    .hm-footer .footer-links a{color:#4b5563}
  </style>
</head>
<body>

<!-- HEADER -->
<header class="hm-header" role="banner">
  <div class="wrap">
    <div class="left">
      <button class="hamburger" id="openMenu" aria-label="Open menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" y1="6"  x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
      <a class="hm-brand" href="index.html">Hemline Market</a>
    </div>

    <div class="right">
      <a class="hm-icon" href="browse.html" aria-label="Browse &amp; search">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="M21 21l-4.3-4.3"></path>
        </svg>
      </a>

      <a class="hm-icon" href="favorites.html" aria-label="Favorites">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
      </a>

      <a class="hm-icon" href="notifications.html" aria-label="Notifications" aria-current="page">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 7h18s-3 0-3-7"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
      </a>

      <a class="hm-icon" href="cart.html" aria-label="Cart">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="9"  cy="21" r="1"></circle>
          <circle cx="18" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
      </a>

      <a class="hm-avatar" id="avatar" href="account.html" title="Your profile">AA</a>
      <a class="hm-btn-primary" href="sell.html">Sell</a>
    </div>
  </div>
</header>

<!-- LEFT MENU -->
<aside class="sheet" id="menuSheet" aria-hidden="true">
  <header>
    <strong>Menu</strong>
    <button class="close" id="closeMenu" aria-label="Close menu">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </header>
  <nav>
    <a href="dashboard.html">Dashboard</a>
    <a href="atelier.html">My Atelier</a>
    <a href="how.html">How It Works</a>
    <a href="sell.html">Sell Fabric</a>
    <a href="contact.html">Contact</a>
  </nav>
</aside>

<main class="wrap">
  <div class="pagehead">
    <h1>Notifications</h1>
    <div class="actions">
      <button class="btn" id="markAll">Mark all as read</button>
      <button class="btn" id="clearAll">Clear</button>
    </div>
  </div>

  <section class="notif-card" id="notifCard">
    <div class="group">Today</div>
    <div class="list" id="listToday"></div>

    <div class="group">Earlier</div>
    <div class="list" id="listEarlier"></div>
  </section>
</main>

<!-- FOOTER -->
<footer class="hm-footer" role="contentinfo">
  <div class="footer-wrap">
    <div class="copy">© 2025 Hemline Market</div>
    <nav class="footer-links" aria-label="Footer">
      <a href="about.html">About</a>
      <a href="faq.html">FAQ</a>
      <a href="contact.html">Contact</a>
      <a href="terms.html">Terms</a>
      <a href="privacy.html">Privacy</a>
    </nav>
  </div>
</footer>

<script>
(function(){
  /* Menu sheet */
  const sheet=document.getElementById("menuSheet");
  const openBtn=document.getElementById("openMenu");
  const closeBtn=document.getElementById("closeMenu");
  function openSheet(){ sheet.classList.add("open"); sheet.setAttribute("aria-hidden","false"); }
  function closeSheet(){ sheet.classList.remove("open"); sheet.setAttribute("aria-hidden","true"); }
  if(openBtn) openBtn.addEventListener("click",e=>{e.preventDefault();openSheet();});
  if(closeBtn) closeBtn.addEventListener("click",e=>{e.preventDefault();closeSheet();});
  document.addEventListener("keydown",e=>{ if(e.key==="Escape") closeSheet(); });

  /* Avatar from localStorage (optional) */
  const avatar=document.getElementById("avatar");
  try{
    const url=localStorage.getItem("avatarUrl");
    if(url){
      avatar.textContent='';
      avatar.style.backgroundImage="url('"+url+"')";
    }
  }catch(e){}

  /* Notifications storage helpers */
  const STORAGE_KEY = 'hm_notifications';

  function getNotifications(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return [];
      const parsed = JSON.parse(raw);
      return Array.isArray(parsed) ? parsed : [];
    }catch(_){
      return [];
    }
  }

  function saveNotifications(list){
    try{
      localStorage.setItem(STORAGE_KEY, JSON.stringify(list || []));
    }catch(_){}
  }

  function markAllRead(){
    const list = getNotifications();
    if(!list.length) return;
    list.forEach(n => { n.unread = false; });
    saveNotifications(list);
    render();
  }

  function clearAll(){
    saveNotifications([]);
    render();
  }

  /* Rendering */
  const listToday  = document.getElementById('listToday');
  const listEarlier= document.getElementById('listEarlier');

  function createItem(n){
    const row = document.createElement('div');
    row.className = 'item' + (n.unread ? '' : ' read');
    row.dataset.id = n.id || '';

    const href = n.href || '#';
    const kind = n.kind || ''; // e.g. "Purchase", "Message"

    row.innerHTML = `
      <span class="dot" aria-hidden="true"></span>
      <div>
        <div class="title">${n.title || 'Notification'}</div>
        <div class="meta">${n.meta || ''}</div>
        ${kind ? `<div class="tag">${kind}</div>` : ''}
      </div>
      <a class="link" href="${href}">View</a>
    `;

    row.addEventListener('click', (e)=>{
      if(e.target.tagName.toLowerCase()==='a') return;
      row.classList.add('read');
      const all = getNotifications();
      const found = all.find(x => x.id === n.id);
      if(found){
        found.unread = false;
        saveNotifications(all);
      }
    });

    return row;
  }

  function render(){
    const items = getNotifications()
      .slice()
      .sort((a,b)=>{
        const da = a.created_at ? new Date(a.created_at).getTime() : 0;
        const db = b.created_at ? new Date(b.created_at).getTime() : 0;
        return db - da;
      });

    listToday.innerHTML   = '';
    listEarlier.innerHTML = '';

    if(!items.length){
      listToday.innerHTML   = '<div class="empty">You’re all caught up.</div>';
      listEarlier.innerHTML = '';
      return;
    }

    const now   = new Date();
    const today = [];
    const earlier = [];

    items.forEach(n=>{
      const t = n.created_at ? new Date(n.created_at) : null;
      if(
        t &&
        t.getFullYear() === now.getFullYear() &&
        t.getMonth() === now.getMonth() &&
        t.getDate() === now.getDate()
      ){
        today.push(n);
      } else {
        earlier.push(n);
      }
    });

    if(today.length){
      today.forEach(n => listToday.appendChild(createItem(n)));
    } else {
      listToday.innerHTML = '<div class="empty">No notifications yet today.</div>';
    }

    if(earlier.length){
      earlier.forEach(n => listEarlier.appendChild(createItem(n)));
    } else {
      listEarlier.innerHTML = '<div class="empty">No earlier notifications.</div>';
    }
  }

  /* Buttons */
  document.getElementById('markAll').addEventListener('click', markAllRead);
  document.getElementById('clearAll').addEventListener('click', clearAll);

  render();
})();
</script>
</body>
</html>
