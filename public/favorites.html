<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hemline Market — Favorites (Closet)</title>
<meta name="theme-color" content="#333333"/>
<style>
  :root{
    --hm-charcoal:#333333; --hm-rosewood:#65000b; --hm-hunter:#355e3b; --hm-black:#000;
    --hm-text:#333333; --hm-muted:#6b7280; --hm-bg:#fff;
    --hm-border:1px solid rgba(0,0,0,.12); --hm-shadow:0 8px 24px rgba(0,0,0,.08);
    --hm-radius:14px; --hm-gap:16px; --hm-cta:#65000b;
  }
  *{box-sizing:border-box}
  html,body{margin:0;color:var(--hm-text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{text-decoration:none;color:#000} a:hover{color:var(--hm-rosewood)}
  img{max-width:100%;display:block}

  /* Header (site-consistent) + cart badge */
  .hm-header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.9);backdrop-filter:saturate(120%) blur(6px);border-bottom:1px solid rgba(0,0,0,.08)}
  .hm-header-inner{height:90px;max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:20px;padding:0 16px}
  .hm-logo img{height:80px}
  .hm-nav{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
  .hm-nav a{font-weight:700}
  .hm-nav .cta{font-weight:900;padding:10px 18px;border-radius:999px;background:var(--hm-cta);color:#fff;border:1px solid #000}
  .cart-link{position:relative;padding-right:10px}
  .cart-count{position:absolute;top:-8px;right:-12px;min-width:20px;height:20px;border-radius:999px;background:#111;color:#fff;display:inline-flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;border:1px solid #000}

  /* Page */
  .wrap{max-width:1200px;margin:26px auto 48px;padding:0 16px}
  .head{display:flex;align-items:baseline;justify-content:space-between;gap:12px;margin-bottom:12px}
  .head h1{margin:0}
  .hint{color:var(--hm-muted)}
  .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px}
  @media (max-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
  @media (max-width:820px){.grid{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:520px){.grid{grid-template-columns:1fr}}

  .card{background:#fff;border:var(--hm-border);border-radius:18px;box-shadow:var(--hm-shadow);overflow:hidden;display:flex;flex-direction:column}
  .thumb{height:180px;background:linear-gradient(0deg,#e9e9e9,#f5f5f5)}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .content{padding:12px 14px}
  .title{font-weight:800;margin:4px 0}
  .meta{color:var(--hm-muted);font-size:13px}
  .price{font-weight:900;margin-top:6px}
  .actions{display:flex;gap:8px;margin:12px 14px 14px}
  .btn{flex:1 1 auto;border:var(--hm-border);background:#fff;border-radius:12px;padding:10px 12px;font-weight:800;cursor:pointer;text-align:center}
  .btn-primary{background:var(--hm-cta);color:#fff;border-color:#000}
  .empty{background:#fff;border:var(--hm-border);border-radius:18px;box-shadow:var(--hm-shadow);padding:26px;text-align:center;margin-top:12px}
  .empty h3{margin:6px 0 4px}
  .pill{display:inline-block;border-radius:999px;border:var(--hm-border);padding:6px 10px;background:#fff;font-weight:800;margin-top:8px}
</style>
</head>
<body>

<header class="hm-header">
  <div class="hm-header-inner">
    <a class="hm-logo" href="/" aria-label="Hemline Market home">
      <img src="/logo.png" alt="Hemline Market logo" onerror="this.style.display='none'">
    </a>
    <nav class="hm-nav" aria-label="Primary">
      <a href="/catalog-v2.html">Browse</a>
      <a href="/favorites">❤ Favorites</a>
      <a href="/account">My Account</a>
      <a href="/cart.html" class="cart-link">Cart <span class="cart-count" data-cart-count>0</span></a>
      <a class="cta" href="/list">List Item</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <div class="head">
    <h1>Favorites</h1>
    <div class="hint">Your closet — saved fabrics live here.</div>
  </div>

  <div id="grid" class="grid"></div>
  <div id="empty" class="empty" style="display:none">
    <h3>Your closet is empty</h3>
    <p class="hint">Tap the ❤ on any listing to save it here. We’ll keep your picks safe.</p>
    <a class="pill" href="/catalog-v2.html">Browse fabrics →</a>
  </div>
</main>

<script>
(function(){
  const FAV_KEY='hm_favs_v1';
  const CART_KEY='hm_cart_v1';

  const $=(s,r=document)=>r.querySelector(s);
  const $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
  const fmt=n=>'$'+(Number(n||0)).toFixed(2);

  function read(k){ try{return JSON.parse(localStorage.getItem(k)||'[]');}catch(e){return [];} }
  function write(k,v){ localStorage.setItem(k,JSON.stringify(v)); }
  function syncCount(){
    const count = read(CART_KEY).reduce((n,i)=>n+(Number(i.qty)||1),0);
    $$('[data-cart-count]').forEach(el=>el.textContent=count);
  }

  function removeFav(sku){
    const items = read(FAV_KEY).filter(x=>x.sku!==sku);
    write(FAV_KEY, items);
    render();
  }

  function addToCart(item){
    const items = read(CART_KEY);
    const i = items.findIndex(x=>x.sku===item.sku);
    if(i>-1){ items[i].qty = (Number(items[i].qty)||1)+1; }
    else { items.push({sku:item.sku,name:item.name,price:item.price,qty:1,image:item.image}); }
    write(CART_KEY, items);
    syncCount();
    alert('Added to cart.');
  }

  function cardHTML(it){
    return `
      <article class="card">
        <div class="thumb">${it.image?`<img src="${it.image}" alt="">`:''}</div>
        <div class="content">
          <div class="title">${it.name||'Fabric'}</div>
          <div class="meta">${it.meta||''}</div>
          <div class="price">${fmt(it.price||0)} / yd</div>
        </div>
        <div class="actions">
          <button class="btn" data-rm="${it.sku}">Remove</button>
          <button class="btn btn-primary" data-add="${it.sku}">Add to cart</button>
        </div>
      </article>
    `;
  }

  function render(){
    const favs = read(FAV_KEY);
    const grid = $('#grid'); const empty = $('#empty');
    if(!favs.length){
      grid.innerHTML=''; empty.style.display='';
      return;
    }
    empty.style.display='none';
    grid.innerHTML = favs.map(cardHTML).join('');

    // wire buttons
    grid.addEventListener('click', (e)=>{
      const sku = e.target.getAttribute('data-rm') || e.target.getAttribute('data-add');
      if(!sku) return;
      const fav = favs.find(f=>f.sku===sku);
      if(!fav) return;
      if(e.target.hasAttribute('data-rm')) removeFav(sku);
      if(e.target.hasAttribute('data-add')) addToCart(fav);
    }, { once:true }); // reattached each render
  }

  // init
  syncCount();
  render();
})();
</script>

</body>
</html>
