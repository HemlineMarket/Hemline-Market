<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Hemline â€” Listings</title>
  <style>
    :root { --ink:#0f172a; --bg:#fafafa; --card:#ffffff; --line:#e5e7eb; }
    body { font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; margin:24px; background:var(--bg); color:var(--ink); }
    .wrap { max-width:1000px; margin:auto; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    .card { background:var(--card); border:1px solid var(--line); border-radius:12px; padding:16px; }
    .card img { max-width:100%; border-radius:12px; }
    .btn { display:inline-block; margin-top:8px; padding:8px 12px; background:#0ea5e9; color:#fff; border-radius:6px; text-decoration:none; cursor:pointer; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Fabric Listings</h1>
    <div class="grid" id="listings"></div>
    <a href="cart.html" class="btn">View Cart</a>
  </div>

  <script type="module">
    const SUPABASE_URL = "https://clkizksbvxjkoatdajgd.supabase.co";
    const SUPABASE_KEY = "YOUR_ACTUAL_ANON_KEY";

    async function loadListings() {
      const res = await fetch(`${SUPABASE_URL}/rest/v1/listings?select=*`, {
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`
        }
      });
      const data = await res.json();
      const container = document.getElementById("listings");
      container.innerHTML = "";
      data.forEach(item => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <img src="${item.image_url || ''}" alt="${item.title}">
          <h3>${item.title}</h3>
          <p>$${item.price}</p>
          <button class="btn" onclick="addToCart(${item.id}, '${item.title}', ${item.price})">Add to Cart</button>
        `;
        container.appendChild(div);
      });
    }

    function addToCart(id, title, price) {
      let cart = JSON.parse(localStorage.getItem("hem_cart")) || [];
      cart.push({ id, title, price });
      localStorage.setItem("hem_cart", JSON.stringify(cart));
      alert(`${title} added to cart!`);
    }

    loadListings();
  </script>
</body>
</html>
