<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Atelier — Hemline Market</title>

  <!-- Shared styles -->
  <link rel="stylesheet" href="styles/hm-modern.css"/>
  <link rel="stylesheet" href="styles/hm-header.css"/>
  <link rel="stylesheet" href="styles/hm-typography.css"/>
  <link rel="stylesheet" href="styles/hm-footer.css"/>
  <link rel="icon" href="/favicon.ico" type="image/x-icon"/>

  <style>
    :root{
      --ink:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --accent:#991b1b;
      --bg:#fafafa;
      --tile:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
    }

    main.wrap{
      max-width:1100px;
      margin:18px auto 28px;
      padding:0 12px;
    }
    h1{
      margin:0 0 8px;
      font-size:26px;
      font-weight:800;
    }
    .subtle{
      color:var(--muted);
      margin:0 0 14px;
      font-size:14px;
    }

    /* Layout: profile + listings */
    .atelier-grid{
      display:grid;
      grid-template-columns:300px minmax(0,1fr);
      gap:18px;
      align-items:flex-start;
    }
    @media (max-width:900px){
      .atelier-grid{
        grid-template-columns:1fr;
      }
    }

    .card{
      background:var(--tile);
      border:1px solid var(--border);
      border-radius:12px;
      box-shadow:0 6px 16px rgba(0,0,0,.06);
    }
    .card .hd{
      padding:10px 12px;
      border-bottom:1px solid var(--border);
      font-weight:800;
      font-size:14px;
    }
    .card .bd{
      padding:12px;
      font-size:14px;
    }

    /* Profile block */
    .profile-top{
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    .profile-avatar{
      width:72px;
      height:72px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      display:grid;
      place-items:center;
      font-weight:800;
      color:#334155;
      background-size:cover;
      background-position:center;
      font-size:22px;
      flex-shrink:0;
    }
    .profile-main{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }
    .profile-name{
      font-weight:800;
    }
    .profile-location{
      font-size:13px;
      color:var(--muted);
    }
    .profile-bio{
      font-size:13px;
      color:#374151;
      margin-top:6px;
    }

    .profile-shop-block{
      margin-top:12px;
      padding-top:10px;
      border-top:1px dashed var(--border);
      font-size:13px;
    }
    .profile-shop-name{
      font-weight:800;
    }
    .profile-tagline{
      color:var(--muted);
      margin-top:2px;
    }

    .profile-links{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .profile-links a{
      font-size:12px;
      padding:5px 9px;
      border-radius:999px;
      border:1px solid var(--border);
      text-decoration:none;
      color:#374151;
      background:#f9fafb;
    }

    .profile-meta-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }
    .pill-soft{
      padding:4px 8px;
      border-radius:999px;
      border:1px dashed var(--border);
      font-size:11px;
      color:#4b5563;
    }

    /* Listings area */
    .listing-header-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:8px;
    }
    .listing-header-row h2{
      font-size:16px;
      margin:0;
      font-weight:800;
    }
    .listing-header-row .meta{
      font-size:13px;
      color:var(--muted);
    }

    .listing-grid{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:10px;
    }
    @media (max-width:900px){
      .listing-grid{
        grid-template-columns:repeat(2,minmax(0,1fr));
      }
    }
    @media (max-width:520px){
      .listing-grid{
        grid-template-columns:1fr;
      }
    }

    .listing-tile{
      background:#fff;
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height:100px;
    }
    .listing-img{
      background:#e5e7eb;
      aspect-ratio:4/3;
      width:100%;
    }
    .listing-body{
      padding:8px 10px 10px;
      display:flex;
      flex-direction:column;
      gap:2px;
      font-size:13px;
    }
    .listing-title{
      font-weight:700;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .listing-meta{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
    }
    .listing-price{
      font-weight:700;
    }
    .listing-yardage{
      font-size:12px;
      color:var(--muted);
    }

    .empty-state{
      font-size:13px;
      color:var(--muted);
      padding:8px 0 2px;
    }

    /* Footer already styled via hm-footer.css */
  </style>
</head>
<body>

<!-- HEADER: same pattern as account/seller-profile, with ThreadTalk -->
<header class="hm-header" role="banner">
  <div class="wrap">
    <div class="left">
      <button class="hamburger" id="openMenu" type="button" aria-label="Open menu" aria-controls="menuSheet" aria-expanded="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" y1="6"  x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
      <a class="hm-brand" href="index.html">Hemline Market</a>
    </div>

    <div class="right">
      <a class="hm-icon" href="browse.html" aria-label="Browse &amp; search">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="M21 21l-4.3-4.3"></path>
        </svg>
      </a>
      <a class="hm-icon" href="ThreadTalk.html" aria-label="ThreadTalk" title="ThreadTalk">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M4 6.5A4.5 4.5 0 0 1 8.5 2h7A4.5 4.5 0 0 1 20 6.5v5A4.5 4.5 0 0 1 15.5 16H12l-4 4v-4H8.5A4.5 4.5 0 0 1 4 11.5z"></path>
        </svg>
      </a>
      <a class="hm-icon" href="favorites.html" aria-label="Favorites">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
      </a>
      <a class="hm-icon" href="notifications.html" aria-label="Notifications">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 7h18s-3 0-3-7"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
      </a>
      <a class="hm-icon" href="cart.html" aria-label="Cart">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="9"  cy="21" r="1"></circle>
          <circle cx="18" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
      </a>

      <!-- Avatar pill (we’ll reuse the same initials/photo as Account) -->
      <a class="hm-avatar" id="headerAvatar" href="account.html" title="Your account">RK</a>

      <a class="hm-btn-primary" href="sell.html">Sell</a>
    </div>
  </div>
</header>

<!-- LEFT MENU -->
<div id="sheetOverlay" aria-hidden="true"></div>

<aside class="sheet" id="menuSheet" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Site menu">
  <header>
    <strong>Menu</strong>
    <button class="close" id="closeMenu" aria-label="Close menu">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </header>
  <nav>
    <a href="browse.html">Browse</a>
    <a href="atelier.html">My Atelier</a>
    <a href="orders.html">Orders</a>
    <a href="favorites.html">Favorites</a>
    <a href="ThreadTalk.html">ThreadTalk</a>
    <a href="account.html">Account</a>
    <a href="help.html">Help</a>
  </nav>
</aside>

<main class="wrap" id="maincontent">
  <h1>Atelier</h1>
  <p class="subtle">
    Your public shop profile and listings. This is what buyers see when they tap your name on a listing.
  </p>

  <div class="atelier-grid">
    <!-- LEFT: Public profile + shop info -->
    <section>
      <article class="card">
        <div class="hd">Profile</div>
        <div class="bd">
          <div class="profile-top">
            <div class="profile-avatar" id="publicProfileAvatar">RK</div>
            <div class="profile-main">
              <div class="profile-name" id="publicProfileName">Hemline Member</div>
              <div class="profile-location" id="publicProfileLocation">City, State</div>
              <div class="profile-bio" id="publicProfileBio">
                A short bio about sewing, fabric, and favorite projects will show here.
              </div>
            </div>
          </div>

          <div class="profile-shop-block">
            <div class="profile-shop-name" id="publicShopName">@loomlab</div>
            <div class="profile-tagline" id="publicShopTagline">
              Designer deadstock &amp; luxury textiles.
            </div>
            <p style="margin:8px 0 0;font-size:13px;color:var(--muted);">
              Shop details and links come from your Seller Profile settings.
            </p>
          </div>

          <div class="profile-links" id="publicShopLinks">
            <a href="#" id="publicShopWebsite" target="_blank" rel="noopener noreferrer" style="display:none;">
              Website
            </a>
            <a href="#" id="publicShopInstagram" target="_blank" rel="noopener noreferrer" style="display:none;">
              Instagram
            </a>
            <a href="#" id="publicShopTiktok" target="_blank" rel="noopener noreferrer" style="display:none;">
              TikTok
            </a>
          </div>

          <div class="profile-meta-row">
            <span id="publicStatsSummary">
              0 completed listings · 0% on-time shipping
            </span>
            <span class="pill-soft">
              Buyers only see this page — not your address or payout info.
            </span>
          </div>
        </div>
      </article>
    </section>

    <!-- RIGHT: listings card -->
    <section>
      <article class="card">
        <div class="hd">Listings</div>
        <div class="bd">
          <div class="listing-header-row">
            <h2>Available fabric</h2>
            <div class="meta" id="listingCountLabel">0 active listings</div>
          </div>

          <!-- Listings grid will be filled from data later -->
          <div class="listing-grid" id="listingGrid">
            <!-- Placeholder tiles so the layout doesn’t look empty while we wire Supabase later -->
            <div class="listing-tile">
              <div class="listing-img"></div>
              <div class="listing-body">
                <div class="listing-title">Your fabric listing will show here</div>
                <div class="listing-meta">
                  <span class="listing-price">$—</span>
                  <span class="listing-yardage">yds</span>
                </div>
              </div>
            </div>
            <div class="listing-tile">
              <div class="listing-img"></div>
              <div class="listing-body">
                <div class="listing-title">Once wired, this pulls real data</div>
                <div class="listing-meta">
                  <span class="listing-price">$—</span>
                  <span class="listing-yardage">yds</span>
                </div>
              </div>
            </div>
            <div class="listing-tile">
              <div class="listing-img"></div>
              <div class="listing-body">
                <div class="listing-title">Designer deadstock, atelier finds…</div>
                <div class="listing-meta">
                  <span class="listing-price">$—</span>
                  <span class="listing-yardage">yds</span>
                </div>
              </div>
            </div>
          </div>

          <div class="empty-state" id="listingEmptyText" style="display:none;">
            No active listings yet. List fabric from your Sell page and they’ll appear here.
          </div>
        </div>
      </article>
    </section>
  </div>
</main>

<footer class="hm-footer" role="contentinfo">
  <div class="footer-wrap">
    <div class="copy">© 2025 Hemline Market</div>
    <nav class="footer-links" aria-label="Footer">
      <a href="about.html">About</a>
      <a href="faq.html">FAQ</a>
      <a href="contact.html">Contact</a>
      <a href="terms.html">Terms</a>
      <a href="privacy.html">Privacy</a>
    </nav>
  </div>
</footer>

<script>
  // Hamburger / menu sheet (same pattern as account/seller-profile)
  (function(){
    const sheet   = document.getElementById('menuSheet');
    const openBtn = document.getElementById('openMenu');
    const closeBtn= document.getElementById('closeMenu');
    const overlay = document.getElementById('sheetOverlay');

    function lockScroll(lock){
      document.body.style.overflow = lock ? 'hidden' : '';
    }
    function openSheet(){
      if (!sheet) return;
      sheet.classList.add('open');
      sheet.setAttribute('aria-hidden','false');
      if (overlay){
        overlay.classList.add('show');
        overlay.setAttribute('aria-hidden','false');
      }
      if (openBtn) openBtn.setAttribute('aria-expanded','true');
      lockScroll(true);
    }
    function closeSheet(){
      if (!sheet) return;
      sheet.classList.remove('open');
      sheet.setAttribute('aria-hidden','true');
      if (overlay){
        overlay.classList.remove('show');
        overlay.setAttribute('aria-hidden','true');
      }
      if (openBtn) openBtn.setAttribute('aria-expanded','false');
      lockScroll(false);
    }

    if (openBtn && closeBtn && sheet){
      openBtn.addEventListener('click', function(e){ e.preventDefault(); openSheet(); });
      closeBtn.addEventListener('click', function(e){ e.preventDefault(); closeSheet(); });
      if (overlay){
        overlay.addEventListener('click', closeSheet);
      }
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape') closeSheet();
      });
    }
  })();

  // Very light wiring for now: reuse stored avatar initials, basic stats placeholders.
  (function(){
    const headerAvatar  = document.getElementById('headerAvatar');
    const publicAvatar  = document.getElementById('publicProfileAvatar');
    const statsSummary  = document.getElementById('publicStatsSummary');
    const listingCount  = document.getElementById('listingCountLabel');
    const listingEmpty  = document.getElementById('listingEmptyText');
    const listingGrid   = document.getElementById('listingGrid');

    try {
      const initials = localStorage.getItem('hm.avatarInitials') || 'RK';
      const avatarUrl = localStorage.getItem('hm.avatarUrl') || '';

      if (headerAvatar && !headerAvatar.style.backgroundImage){
        headerAvatar.textContent = initials;
      }
      if (publicAvatar){
        if (avatarUrl){
          publicAvatar.textContent = '';
          publicAvatar.style.backgroundImage = "url('" + avatarUrl + "')";
        } else {
          publicAvatar.textContent = initials;
        }
      }

      // Simple demo stats while we haven’t wired real data yet
      const completed = Number(localStorage.getItem('hm.seller.completed') || 0);
      const ontime    = Number(localStorage.getItem('hm.seller.ontime') || 0);
      const safePct   = Math.max(0, Math.min(100, ontime));

      if (statsSummary){
        statsSummary.textContent = `${completed} completed listings · ${safePct}% on-time shipping`;
      }
      if (listingCount){
        listingCount.textContent = `${completed} active listings`;
      }

      // If there are zero listings, hide the placeholder tiles and show empty message
      if (completed === 0 && listingGrid && listingEmpty){
        listingGrid.style.opacity = 0.3;
        listingEmpty.style.display = 'block';
      }
    } catch (e) {
      // fail quietly
    }
  })();
</script>
</body>
</html>
