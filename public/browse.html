<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hemline Market — Browse</title>
<meta name="theme-color" content="#333333"/>
<style>
  :root{
    /* Brand */
    --hm-charcoal:#333333; --hm-rosewood:#65000b; --hm-hunter:#355e3b; --hm-black:#000;
    --hm-bg:#ffffff; --hm-surface:#ffffff; --hm-text:var(--hm-charcoal); --hm-muted:#6b7280;

    /* Layout tokens */
    --hm-header-h:140px; --hm-gap:12px; --hm-radius:14px;
    --hm-border:1px solid rgba(0,0,0,.10); --hm-shadow:0 6px 16px rgba(0,0,0,.08);

    /* Buttons/Chips */
    --hm-chip:#f8f8f8; --hm-chip-text:var(--hm-charcoal);
    --hm-cta-fg:#fff; --hm-cta-bg:var(--hm-rosewood); --hm-cta-bg-hover:#7e0a15;

    /* Z */
    --hm-z-header:70; --hm-z-overlay:60; --hm-z-drawer:61;
  }

  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--hm-bg);color:var(--hm-text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
  img{max-width:100%;height:auto;display:block}
  a{color:var(--hm-black);text-decoration:none}
  a:hover{color:var(--hm-rosewood)}

  /* HEADER (matches homepage) */
  .hm-header{position:sticky;top:0;z-index:var(--hm-z-header);height:var(--hm-header-h);background:var(--hm-surface);border-bottom:var(--hm-border)}
  .hm-header-inner{height:100%;display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:18px;padding:0 16px;max-width:1200px;margin:0 auto}
  .hm-logo img{height:120px}
  .hm-nav{display:flex;gap:22px;align-items:center;justify-content:center}
  .hm-nav a{padding:8px 10px;border-radius:10px;font-weight:700;color:var(--hm-black)}
  .hm-nav a:hover{background:rgba(53,94,59,.10)}
  .hm-nav .cta{font-weight:900;padding:12px 18px;border-radius:999px;background:var(--hm-cta-bg);color:var(--hm-cta-fg);border:1px solid var(--hm-black);box-shadow:0 2px 0 rgba(0,0,0,.06)}
  .hm-nav .cta:hover{background:var(--hm-cta-bg-hover)}
  .hm-icon{width:18px;height:18px;margin-right:6px;vertical-align:-3px}
  @media (max-width:860px){
    .hm-header-inner{grid-template-columns:auto 1fr auto}
    .hm-nav{gap:14px;font-size:14px}
    .hm-logo img{height:100px}
  }

  /* LAYOUT */
  .hm-layout{display:grid;grid-template-columns:340px 1fr;gap:20px;align-items:start;padding:20px;max-width:1200px;margin:0 auto}
  @media (max-width:980px){.hm-layout{grid-template-columns:1fr;padding:12px}}

  /* FILTERS PANEL */
  #filters-panel{position:sticky;top:var(--hm-header-h);max-height:calc(100vh - var(--hm-header-h) - 16px);overflow:auto;background:var(--hm-surface);border:var(--hm-border);border-radius:var(--hm-radius);box-shadow:var(--hm-shadow);padding:12px}
  @media (max-width:980px){
    #filters-panel{position:fixed;top:0;left:0;height:100dvh;width:min(92vw,390px);transform:translateX(-105%);transition:transform .28s ease;border-radius:0 16px 16px 0;padding:14px;z-index:var(--hm-z-drawer)}
    #filters-panel.is-open{transform:translateX(0)} #filters-panel .drawer-spacer{height:8px}
  }
  #filters-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:opacity .28s ease;z-index:var(--hm-z-overlay)}
  #filters-overlay.is-open{opacity:1;pointer-events:auto}
  .drawer-header{display:none;align-items:center;justify-content:space-between;gap:8px;margin:-4px 0 8px;padding-bottom:8px;border-bottom:var(--hm-border)}
  @media (max-width:980px){.drawer-header{display:flex}}
  .drawer-title{font-weight:700}
  .drawer-close{border:var(--hm-border);background:#fff;cursor:pointer;width:36px;height:36px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center}
  #filters-panel details{border-bottom:var(--hm-border);padding:4px 0 8px}
  #filters-panel details:last-of-type{border-bottom:0}
  #filters-panel summary{list-style:none;cursor:pointer;display:flex;align-items:center;justify-content:space-between;padding:8px 4px;font-weight:800;color:var(--hm-text)}
  #filters-panel summary::-webkit-details-marker{display:none}
  #filters-panel .summary-caret{margin-left:8px;transition:transform .25s ease}
  #filters-panel details[open] .summary-caret{transform:rotate(90deg)}
  .filter-body{padding:6px 4px 10px;display:grid;gap:8px}
  .filter-grid-2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  @media (max-width:480px){.filter-grid-2{grid-template-columns:1fr}}
  .hm-input,.hm-select{width:100%;padding:12px 14px;border-radius:12px;border:var(--hm-border);font-size:14px}
  .hm-checklist{display:grid;gap:6px;max-height:230px;overflow:auto;padding-right:4px}
  .hm-check{display:flex;align-items:center;gap:10px;font-size:14px;color:var(--hm-text)}
  .hm-check input{width:16px;height:16px}

  /* Chips + toolbar + results */
  #active-filter-chips{display:flex;flex-wrap:wrap;gap:8px;margin:4px 0 10px}
  .hm-chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:var(--hm-chip);color:var(--hm-chip-text);font-size:12px;border:var(--hm-border)}
  .hm-chip button{border:0;background:transparent;cursor:pointer;font-size:14px}
  .toolbar{display:flex;align-items:center;justify-content:flex-end;gap:12px;margin:0 0 10px}
  .toolbar label{font-weight:600;color:var(--hm-black)}
  .toolbar .hm-select{width:auto;min-width:220px}
  #results-summary{margin:2px 0 6px;font-size:13px;color:var(--hm-muted)}
  #results-summary strong{color:var(--hm-black)}
  .results-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px}
  @media (max-width:1100px){.results-grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media (max-width:640px){.results-grid{grid-template-columns:1fr}}
  .result-card{border:var(--hm-border);border-radius:12px;overflow:hidden;background:#fff}
  .thumb{width:100%;height:180px;display:block}
  .thumb--wool{background:repeating-linear-gradient(45deg,#0000000d 0 8px,#ffffff10 8px 16px),linear-gradient(0deg,#d8d6d1,#e6e1db)}
  .thumb--silk{background:linear-gradient(135deg,#ffffff80,#ffffff00 40%),linear-gradient(315deg,#0000000d,#0000 45%),linear-gradient(0deg,#f2ede8,#e7e1db)}
  .thumb--cotton{background:repeating-linear-gradient(0deg,#00000008 0 2px,#0000 2px 4px),repeating-linear-gradient(90deg,#00000008 0 2px,#0000 2px 4px),linear-gradient(0deg,#e9e9e9,#f5f5f5)}
  .thumb--sateen{background:linear-gradient(90deg,#ffffffb3 0 20%,#ffffff00 40% 60%,#ffffff99 80% 100%),linear-gradient(0deg,#dedfe6,#cfd3de)}
  .thumb--crepe{background:radial-gradient(circle at 20% 30%,#0000000f 0 12%,#0000 13%),radial-gradient(circle at 70% 60%,#0000000d 0 10%,#0000 11%),linear-gradient(0deg,#e6e3e1,#f0eeeb)}
  .rc-body{padding:10px 12px}
  .rc-title{font-weight:700;margin:0 0 6px}
  .rc-meta{margin:0 0 4px;color:var(--hm-muted);font-size:12px}
  .rc-price{color:var(--hm-black);font-weight:800}

  /* FOOTER (matches homepage) */
  footer{border-top:var(--hm-border);margin-top:28px}
  .footer-inner{max-width:1200px;margin:0 auto;padding:18px 16px;color:var(--hm-muted);display:flex;flex-wrap:wrap;gap:12px;justify-content:center;font-size:13px}
  .footer-inner a{color:var(--hm-muted)}
  .footer-inner a:hover{color:var(--hm-rosewood)}
</style>
</head>
<body>

<!-- HEADER -->
<header class="hm-header" role="banner">
  <div class="hm-header-inner">
    <a class="hm-logo" href="/" aria-label="Hemline Market home">
      <img src="/logo.png" alt="Hemline Market logo" onerror="this.style.display='none'">
    </a>
    <nav class="hm-nav" aria-label="Primary">
      <a href="/new">New Arrivals</a>
      <a href="/atelier">My Atelier</a>
      <a href="/browse.html">Browse</a>
      <a href="/favorites" aria-label="Favorites"><svg class="hm-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20.8 4.6c-1.8-1.8-4.8-1.8-6.6 0L12 6.8l-2.2-2.2c-1.8-1.8-4.8-1.8-6.6 0-1.8 1.8-1.8 4.8 0 6.6l8.8 8.8 8.8-8.8c1.8-1.8 1.8-4.8 0-6.6z"/></svg>Favorites</a>
      <a href="/account">My Account</a>
      <a class="cta" href="/seller.html">List Item</a>
    </nav>
    <div aria-hidden="true"></div>
  </div>
</header>

<main class="hm-layout">
  <!-- Mobile filter open -->
  <div class="hm-topbar" style="display:none"><!-- no topbar button on desktop-only version --></div>
  <div id="filters-overlay" aria-hidden="true"></div>

  <!-- FILTERS -->
  <aside id="filters-panel" aria-label="Filters" aria-modal="true">
    <div class="drawer-header">
      <div class="drawer-title">Filters</div>
      <button class="drawer-close" type="button" aria-label="Close filters">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18.3 5.71 12 12l6.3 6.29-1.41 1.42L10.59 13.4 4.29 19.7 2.88 18.29 9.17 12 2.88 5.71 4.29 4.29l6.3 6.3 6.29-6.3z"/></svg>
      </button>
    </div>

    <!-- Department -->
    <details open>
      <summary>Department <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist">
        <label class="hm-check"><input type="checkbox" name="department" value="fashion"  data-group-label="Department">Fashion</label>
        <label class="hm-check"><input type="checkbox" name="department" value="home"     data-group-label="Department">Home</label>
        <label class="hm-check"><input type="checkbox" name="department" value="quilting" data-group-label="Department">Quilting</label>
        <label class="hm-check"><input type="checkbox" name="department" value="notions"  data-group-label="Department">Notions</label>
      </div>
    </details>

    <!-- Fabric Content (with Any) -->
    <details open>
      <summary>Fabric Content <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist" data-sort="alpha" data-group="content">
        <label class="hm-check"><input type="checkbox" name="content" value="any" data-role="any" data-group-label="Fabric Content">Any</label>
        <label class="hm-check"><input type="checkbox" name="content" value="acetate" data-group-label="Fabric Content">Acetate</label>
        <label class="hm-check"><input type="checkbox" name="content" value="acrylic" data-group-label="Fabric Content">Acrylic</label>
        <label class="hm-check"><input type="checkbox" name="content" value="alpaca" data-group-label="Fabric Content">Alpaca</label>
        <label class="hm-check"><input type="checkbox" name="content" value="bamboo" data-group-label="Fabric Content">Bamboo</label>
        <label class="hm-check"><input type="checkbox" name="content" value="cashmere" data-group-label="Fabric Content">Cashmere</label>
        <label class="hm-check"><input type="checkbox" name="content" value="cotton" data-group-label="Fabric Content">Cotton</label>
        <label class="hm-check"><input type="checkbox" name="content" value="cupro" data-group-label="Fabric Content">Cupro</label>
        <label class="hm-check"><input type="checkbox" name="content" value="elastane" data-group-label="Fabric Content">Elastane/Spandex</label>
        <label class="hm-check"><input type="checkbox" name="content" value="hemp" data-group-label="Fabric Content">Hemp</label>
        <label class="hm-check"><input type="checkbox" name="content" value="leather" data-group-label="Fabric Content">Leather</label>
        <label class="hm-check"><input type="checkbox" name="content" value="linen" data-group-label="Fabric Content">Linen</label>
        <label class="hm-check"><input type="checkbox" name="content" value="modal" data-group-label="Fabric Content">Modal</label>
        <label class="hm-check"><input type="checkbox" name="content" value="mohair" data-group-label="Fabric Content">Mohair</label>
        <label class="hm-check"><input type="checkbox" name="content" value="nylon" data-group-label="Fabric Content">Nylon</label>
        <label class="hm-check"><input type="checkbox" name="content" value="polyamide" data-group-label="Fabric Content">Polyamide</label>
        <label class="hm-check"><input type="checkbox" name="content" value="polyester" data-group-label="Fabric Content">Polyester</label>
        <label class="hm-check"><input type="checkbox" name="content" value="polyurethane" data-group-label="Fabric Content">Polyurethane</label>
        <label class="hm-check"><input type="checkbox" name="content" value="rayon" data-group-label="Fabric Content">Rayon/Viscose</label>
        <label class="hm-check"><input type="checkbox" name="content" value="silk" data-group-label="Fabric Content">Silk</label>
        <label class="hm-check"><input type="checkbox" name="content" value="tencel" data-group-label="Fabric Content">Tencel</label>
        <label class="hm-check"><input type="checkbox" name="content" value="triacetate" data-group-label="Fabric Content">Triacetate</label>
        <label class="hm-check"><input type="checkbox" name="content" value="wool" data-group-label="Fabric Content">Wool</label>
      </div>
    </details>

    <!-- Material Class -->
    <details open>
      <summary>Material Class <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist">
        <label class="hm-check"><input type="radio" name="material_class" value="" checked data-group-label="Material Class">Any</label>
        <label class="hm-check"><input type="radio" name="material_class" value="natural" data-group-label="Material Class">Natural</label>
        <label class="hm-check"><input type="radio" name="material_class" value="modified_natural" data-group-label="Material Class">Modified Natural</label>
        <label class="hm-check"><input type="radio" name="material_class" value="synthetic" data-group-label="Material Class">Synthetic</label>
        <label class="hm-check"><input type="radio" name="material_class" value="blend" data-group-label="Material Class">Blend</label>
      </div>
    </details>

    <!-- Fabric Type (with Any) -->
    <details open>
      <summary>Fabric Type <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist" data-sort="alpha" data-group="type">
        <label class="hm-check"><input type="checkbox" name="type" value="any" data-role="any" data-group-label="Fabric Type">Any</label>
        <label class="hm-check"><input type="checkbox" name="type" value="boucle" data-group-label="Fabric Type">Bouclé</label>
        <label class="hm-check"><input type="checkbox" name="type" value="canvas" data-group-label="Fabric Type">Canvas</label>
        <label class="hm-check"><input type="checkbox" name="type" value="chiffon" data-group-label="Fabric Type">Chiffon</label>
        <label class="hm-check"><input type="checkbox" name="type" value="corduroy" data-group-label="Fabric Type">Corduroy</label>
        <label class="hm-check"><input type="checkbox" name="type" value="crepe" data-group-label="Fabric Type">Crepe</label>
        <label class="hm-check"><input type="checkbox" name="type" value="denim" data-group-label="Fabric Type">Denim</label>
        <label class="hm-check"><input type="checkbox" name="type" value="gabardine" data-group-label="Fabric Type">Gabardine</label>
        <label class="hm-check"><input type="checkbox" name="type" value="georgette" data-group-label="Fabric Type">Georgette</label>
        <label class="hm-check"><input type="checkbox" name="type" value="jersey" data-group-label="Fabric Type">Jersey</label>
        <label class="hm-check"><input type="checkbox" name="type" value="lace" data-group-label="Fabric Type">Lace</label>
        <label class="hm-check"><input type="checkbox" name="type" value="leather" data-group-label="Fabric Type">Leather</label>
        <label class="hm-check"><input type="checkbox" name="type" value="organza" data-group-label="Fabric Type">Organza</label>
        <label class="hm-check"><input type="checkbox" name="type" value="poplin" data-group-label="Fabric Type">Poplin</label>
        <label class="hm-check"><input type="checkbox" name="type" value="sateen" data-group-label="Fabric Type">Sateen</label>
        <label class="hm-check"><input type="checkbox" name="type" value="satin" data-group-label="Fabric Type">Satin</label>
        <label class="hm-check"><input type="checkbox" name="type" value="tulle" data-group-label="Fabric Type">Tulle</label>
        <label class="hm-check"><input type="checkbox" name="type" value="tweed" data-group-label="Fabric Type">Tweed</label>
        <label class="hm-check"><input type="checkbox" name="type" value="twill" data-group-label="Fabric Type">Twill</label>
        <label class="hm-check"><input type="checkbox" name="type" value="velvet" data-group-label="Fabric Type">Velvet</label>
        <label class="hm-check"><input type="checkbox" name="type" value="voile" data-group-label="Fabric Type">Voile</label>
      </div>
    </details>

    <!-- Color Family -->
    <details>
      <summary>Color Family <span class="summary-caret">›</span></summary>
      <div class="filter-body">
        <div class="swatches" aria-label="Color Family">
          <label class="swatch" title="Black"><input type="checkbox" name="color" value="black"><span class="box" style="background:#000;"></span></label>
          <label class="swatch" title="Grey"><input type="checkbox" name="color" value="grey"><span class="box" style="background:#b3b7bd;"></span></label>
          <label class="swatch" title="White"><input type="checkbox" name="color" value="white"><span class="box" style="background:#fff;"></span></label>
          <label class="swatch" title="Ivory"><input type="checkbox" name="color" value="ivory"><span class="box" style="background:#fff8e7;"></span></label>
          <label class="swatch" title="Brown"><input type="checkbox" name="color" value="brown"><span class="box" style="background:#7c4a2c;"></span></label>
          <label class="swatch" title="Pink"><input type="checkbox" name="color" value="pink"><span class="box" style="background:#f3a4b7;"></span></label>
          <label class="swatch" title="Red"><input type="checkbox" name="color" value="red"><span class="box" style="background:#e10019;"></span></label>
          <label class="swatch" title="Orange"><input type="checkbox" name="color" value="orange"><span class="box" style="background:#ff9800;"></span></label>
          <label class="swatch" title="Yellow"><input type="checkbox" name="color" value="yellow"><span class="box" style="background:#ffd600;"></span></label>
          <label class="swatch" title="Green"><input type="checkbox" name="color" value="green"><span class="box" style="background:#0d6a2f;"></span></label>
          <label class="swatch" title="Blue"><input type="checkbox" name="color" value="blue"><span class="box" style="background:#1246ff;"></span></label>
          <label class="swatch" title="Purple"><input type="checkbox" name="color" value="purple"><span class="box" style="background:#6a1b9a;"></span></label>
          <label class="swatch" title="Silver"><input type="checkbox" name="color" value="silver"><span class="box" style="background:linear-gradient(135deg,#d7d7d7,#f4f4f4);"></span></label>
          <label class="swatch" title="Gold"><input type="checkbox" name="color" value="gold"><span class="box" style="background:linear-gradient(135deg,#d0a84f,#ffe49b);"></span></label>
        </div>
      </div>
    </details>

    <!-- Price/Width/Weight/Yards -->
    <details open>
      <summary>Price (per yard) <span class="summary-caret">›</span></summary>
      <div class="filter-body filter-grid-2">
        <input class="hm-input" type="number" placeholder="Min" data-role="min" data-group="price" data-group-label="Price/yd">
        <input class="hm-input" type="number" placeholder="Max" data-role="max" data-group="price" data-group-label="Price/yd">
      </div>
    </details>
    <details><summary>Width (in) <span class="summary-caret">›</span></summary>
      <div class="filter-body filter-grid-2">
        <input class="hm-input" type="number" placeholder="Min" data-role="min" data-group="width" data-group-label="Width (in)">
        <input class="hm-input" type="number" placeholder="Max" data-role="max" data-group="width" data-group-label="Width (in)">
      </div>
    </details>
    <details><summary>Weight (GSM) <span class="summary-caret">›</span></summary>
      <div class="filter-body filter-grid-2">
        <input class="hm-input" type="number" placeholder="Min" data-role="min" data-group="weight" data-group-label="Weight (GSM)">
        <input class="hm-input" type="number" placeholder="Max" data-role="max" data-group="weight" data-group-label="Weight (GSM)">
      </div>
    </details>
    <details><summary>Min Yards Available <span class="summary-caret">›</span></summary>
      <div class="filter-body">
        <input class="hm-input" type="number" inputmode="decimal" min="0.5" step="0.5" placeholder="e.g. 0.5" data-filter-key="min_yards" data-group-label="Min yards available">
      </div>
    </details>

    <!-- Condition / Pattern -->
    <details><summary>Condition <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist">
        <label class="hm-check"><input type="radio" name="condition" value="" checked data-group-label="Condition">Any</label>
        <label class="hm-check"><input type="radio" name="condition" value="new" data-group-label="Condition">New</label>
        <label class="hm-check"><input type="radio" name="condition" value="washed" data-group-label="Condition">Washed</label>
        <label class="hm-check"><input type="radio" name="condition" value="used" data-group-label="Condition">Used</label>
      </div>
    </details>
    <details><summary>Pattern <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist">
        <label class="hm-check"><input type="radio" name="pattern" value="" checked data-group-label="Pattern">Any</label>
        <label class="hm-check"><input type="radio" name="pattern" value="solid" data-group-label="Pattern">Solid</label>
        <label class="hm-check"><input type="radio" name="pattern" value="pattern" data-group-label="Pattern">Pattern</label>
      </div>
    </details>

    <!-- Country -->
    <details><summary>Country Made <span class="summary-caret">›</span></summary>
      <div class="filter-body hm-checklist" data-sort="alpha">
        <label class="hm-check"><input type="checkbox" name="country" value="france" data-group-label="Country">France</label>
        <label class="hm-check"><input type="checkbox" name="country" value="italy"  data-group-label="Country">Italy</label>
        <label class="hm-check"><input type="checkbox" name="country" value="japan"  data-group-label="Country">Japan</label>
        <label class="hm-check"><input type="checkbox" name="country" value="uk"     data-group-label="Country">UK</label>
        <label class="hm-check"><input type="checkbox" name="country" value="usa"    data-group-label="Country">USA</label>
        <label class="hm-check"><input type="checkbox" name="country" value="other"  data-group-label="Country">Other</label>
      </div>
    </details>

    <div class="drawer-spacer"></div>
    <div class="filters-cta" style="padding-top:6px">
      <div class="cta-row" style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <button type="button" class="hm-btn" data-action="reset-filters">Reset</button>
        <button type="button" class="hm-btn hm-btn--primary" data-action="apply-filters">Apply</button>
      </div>
    </div>
  </aside>

  <!-- RESULTS -->
  <section id="category-results">
    <div id="results-summary" aria-live="polite"></div>

    <div class="toolbar">
      <label for="sort">Sort</label>
      <select id="sort" class="hm-select" name="sort">
        <option value="">Featured</option>
        <option value="newest">Newest</option>
        <option value="price_asc">Price (Low → High)</option>
        <option value="price_desc">Price (High → Low)</option>
        <option value="yards_desc">Yardage (High → Low)</option>
        <option value="width_desc">Width (Wide → Narrow)</option>
      </select>
    </div>

    <div id="active-filter-chips"></div>
    <div class="results-grid" id="results"></div>
  </section>
</main>

<!-- FOOTER -->
<footer>
  <div class="footer-inner">
    <a href="/faq">FAQ</a> ·
    <a href="/contact">Contact Us</a> ·
    <a href="/feedback">Site Feedback</a> ·
    <a href="/privacy">Privacy</a> ·
    <a href="/terms">Terms &amp; Conditions</a> ·
    <a href="/subscribe">Subscribe</a>
  </div>
</footer>

<script>
(function(){
  /* Demo DATA */
  const DATA = [
    { id:'wool-crepe-1', title:'Sample Wool Crepe', pricePerYd:45, yards:12, widthIn:58, weightGsm:210, country:'italy', department:['fashion'], pattern:'solid', condition:'new', content:['wool'],  type:['crepe'],           colors:['black','grey'], thumb:'wool' },
    { id:'silk-twill-1', title:'Italian Silk Twill', pricePerYd:68, yards:6,  widthIn:54, weightGsm:90,  country:'italy', department:['fashion'], pattern:'pattern', condition:'washed', content:['silk'],  type:['twill','satin'],  colors:['blue','gold'],  thumb:'silk' },
    { id:'cotton-sateen-1', title:'Cotton Sateen',  pricePerYd:22, yards:20, widthIn:60, weightGsm:180, country:'usa',   department:['fashion','quilting'], pattern:'solid', condition:'used', content:['cotton'],type:['sateen'],        colors:['white','ivory'],thumb:'cotton' },
    { id:'leather-lamb-1', title:'Lamb Leather Nappa', pricePerYd:95, yards:4, widthIn:48, weightGsm:600, country:'france', department:['fashion'], pattern:'solid', condition:'new', content:['leather'], type:['leather'], colors:['brown','black'], thumb:'crepe' }
  ];

  const $ = (sel,root=document)=>root.querySelector(sel);
  const $$ = (sel,root=document)=>Array.from(root.querySelectorAll(sel));

  const panel = $('#filters-panel');
  const chipsRow  = $('#active-filter-chips');
  const overlay   = $('#filters-overlay');
  const closeBtn  = panel.querySelector('.drawer-close');
  const sortSel   = $('#sort');
  const summaryEl = $('#results-summary');
  const resultsEl = $('#results');

  overlay?.addEventListener('click', ()=>closeDrawer());
  closeBtn?.addEventListener('click', ()=>closeDrawer());
  function openDrawer(){ panel.classList.add('is-open'); overlay.classList.add('is-open'); }
  function closeDrawer(){ panel.classList.remove('is-open'); overlay.classList.remove('is-open'); }

  /* Alpha sort long lists */
  (function sortChecklists(){
    $$('.hm-checklist', panel).forEach(list=>{
      if (!list.hasAttribute('data-sort') && list.children.length < 6) return;
      const items = Array.from(list.children);
      items.sort((a,b)=> a.textContent.trim().localeCompare(b.textContent.trim(), undefined, {sensitivity:'base'}));
      items.forEach(n=>list.appendChild(n));
    });
  })();

  /* Render results */
  function render(rows){
    resultsEl.innerHTML = rows.map(item=>{
      const thumbClass = { wool:'thumb--wool', silk:'thumb--silk', cotton:'thumb--cotton', sateen:'thumb--sateen', crepe:'thumb--crepe' }[item.thumb] || 'thumb--cotton';
      return `
        <article class="result-card" data-id="${item.id}">
          <div class="thumb ${thumbClass}" role="img" aria-label="${item.title} swatch"></div>
          <div class="rc-body">
            <p class="rc-title">${item.title}</p>
            <p class="rc-meta">${item.yards} yd • ${item.widthIn}″ • ${item.country.toUpperCase()}</p>
            <p class="rc-price">$${item.pricePerYd} / yd</p>
          </div>
        </article>
      `;
    }).join('');
  }
  render(DATA);

  /* Chips helpers */
  const keyFor = el=> el.getAttribute('name') || el.getAttribute('data-filter-key') || el.id || '';
  const formatLabel = el=>{
    const id = el.id; if (id){ const lbl = panel.querySelector('label[for="'+id+'"]'); if (lbl) return lbl.textContent.trim(); }
    if (el.tagName==='SELECT') return el.options[el.selectedIndex]?.text?.trim()||'';
    return (el.value||'').trim();
  };
  const addChip = (key,label,clearFn)=>{
    chipsRow.querySelectorAll('[data-chip-key="'+key+'"]').forEach(n=>n.remove());
    if(!label) return;
    const chip=document.createElement('span');
    chip.className='hm-chip'; chip.dataset.chipKey=key;
    chip.innerHTML='<span>'+label+'</span><button type="button" aria-label="Clear '+label+'">✕</button>';
    chip.querySelector('button').addEventListener('click',()=>{ clearFn?.(); chip.remove(); panel.dispatchEvent(new CustomEvent('filters:change',{bubbles:true})); triggerApply(false); });
    chipsRow.appendChild(chip);
  };

  /* “Any” checkbox behavior for multi-select groups (content/type) */
  function wireAnyGroup(name){
    const group = $$('input[name="'+name+'"]', panel);
    const anyBox = group.find(i=>i.value==='any');
    if(!anyBox) return;
    group.forEach(i=>{
      i.addEventListener('change', ()=>{
        if(i===anyBox && anyBox.checked){
          group.forEach(o=>{ if(o!==anyBox) o.checked=false; });
        }else if(i!==anyBox && i.checked){
          anyBox.checked=false;
        }
      });
    });
  }
  wireAnyGroup('content');
  wireAnyGroup('type');

  /* Wire inputs -> chips + auto-apply */
  function wireInput(el){
    const key = keyFor(el); if(!key) return;
    const update = ()=>{
      let label='';
      if (el.type==='checkbox'){
        const group=$$('input[name="'+el.name+'"]', panel).filter(i=>i.checked);
        /* hide chip when 'Any' is the only selection */
        const onlyAny = group.length===1 && group[0].value==='any';
        if (!group.length || onlyAny){
          addChip(el.name,'',()=> group.forEach(i=> i.checked=false));
        } else {
          label = (el.getAttribute('data-group-label')||el.name)+': '+group.filter(i=>i.value!=='any').map(formatLabel).join(', ');
          addChip(el.name,label,()=> $$('input[name="'+el.name+'"]',panel).forEach(i=> i.checked=false));
        }
      } else if (el.type==='radio'){
        const checked=$$('input[name="'+el.name+'"]', panel).find(i=>i.checked && i.value!=='');
        label = checked ? (el.getAttribute('data-group-label')||el.name)+': '+formatLabel(checked) : '';
        addChip(el.name,label,()=> { $$('input[name="'+el.name+'"]',panel).forEach(r=> r.checked=(r.value==='')); });
      } else if (['number','text','search'].includes(el.type)){
        if (el.dataset.role && el.dataset.group){
          const g=el.dataset.group;
          const from=panel.querySelector('[data-group="'+g+'"][data-role="min"]')?.value||'';
          const to=panel.querySelector('[data-group="'+g+'"][data-role="max"]')?.value||'';
          const any=from||to;
          addChip(g, any ? (el.getAttribute('data-group-label')||g)+': '+(from||'—')+' to '+(to||'—') : '', ()=>{
            const a=panel.querySelector('[data-group="'+g+'"][data-role="min"]'); const b=panel.querySelector('[data-group="'+g+'"][data-role="max"]');
            if(a) a.value=''; if(b) b.value='';
          });
        } else {
          label=el.value ? (el.getAttribute('data-group-label')||key)+': '+el.value : '';
          addChip(key,label,()=>{ el.value=''; });
        }
      }
    };
    update();
    el.addEventListener('change', ()=>{ update(); triggerApply(false); });
    el.addEventListener('input', ()=>{ if(['number','text','search'].includes(el.type)){ update(); debouncedApply(); }});
  }
  $$('.filter-body input, .filter-body select', panel).forEach(wireInput);

  /* Collect query */
  function collectQuery(){
    const query = {};
    $$('.filter-body input, .filter-body select', panel).forEach(el=>{
      const key = keyFor(el); if(!key) return;
      if (el.type==='checkbox'){
        (query[key] ||= []);
        if(el.checked){
          if(el.value==='any'){ query[key]=[]; } else { query[key].push(el.value); }
        }
      } else if (el.type==='radio'){ if (el.checked && el.value!=='') query[key]=el.value; }
      else if (['number','text','search'].includes(el.type)){
        if (el.dataset.role && el.dataset.group){
          const g=el.dataset.group; (query[g] ||= {});
          if (el.value!=='') query[g][el.dataset.role]=el.value;
        } else if (el.value){ query[key]=el.value; }
      }
    });
    if (sortSel && sortSel.value) query.sort = sortSel.value;
    return query;
  }

  function labelForSort(v){
    if(v==='newest') return 'Newest';
    if(v==='price_asc') return 'Price (Low → High)';
    if(v==='price_desc') return 'Price (High → Low)';
    if(v==='yards_desc') return 'Yardage (High → Low)';
    if(v==='width_desc') return 'Width (Wide → Narrow)';
    return 'Featured';
  }

  /* Filtering with yards clamp to >= 0.5 and 0.5 steps */
  function clampHalf(x){
    const n = Math.max(0.5, Number(x||0.5));
    return Math.round(n*2)/2; // force 0.5 increments
  }

  function filterRows(query){
    let rows = DATA.slice();

    // multi-selects
    ['content','type','color','department','country'].forEach(field=>{
      const selected = query[field];
      if (!selected || !selected.length) return;
      rows = rows.filter(it => (it[field]||[]).some(v => selected.includes(v)));
    });

    // radios
    if (query.pattern) rows = rows.filter(it => it.pattern===query.pattern);
    if (query.condition) rows = rows.filter(it => it.condition===query.condition);

    // numeric ranges
    function range(g, getter){
      const r = query[g]; if (!r || (r.min==null && r.max==null)) return;
      const min = r.min!=null ? Number(r.min) : -Infinity;
      const max = r.max!=null ? Number(r.max) : Infinity;
      rows = rows.filter(it => { const val = getter(it); return val>=min && val<=max; });
    }
    range('price', it=> it.pricePerYd);
    range('width', it=> it.widthIn);
    range('weight', it=> it.weightGsm);

    // min yards (>= 0.5, 0.5 increments)
    if (query.min_yards){
      const need = clampHalf(query.min_yards);
      rows = rows.filter(it => Math.round((it.yards)*2)/2 >= need);
    }

    // sort
    switch(query.sort){
      case 'price_asc': rows.sort((a,b)=> a.pricePerYd - b.pricePerYd); break;
      case 'price_desc': rows.sort((a,b)=> b.pricePerYd - a.pricePerYd); break;
      case 'yards_desc': rows.sort((a,b)=> b.yards - a.yards); break;
      case 'width_desc': rows.sort((a,b)=> b.widthIn - a.widthIn); break;
      case 'newest': rows.sort((a,b)=> (b.id > a.id ? 1 : -1)); break;
      default: break;
    }
    return rows;
  }

  function updateSummary(query, count){
    const chipTexts = Array.from(document.querySelectorAll('#active-filter-chips .hm-chip span:first-child')).map(n=>n.textContent.trim());
    const parts = [];
    if (chipTexts.length) parts.push(chipTexts.join(' • '));
    if (query.sort) parts.push('Sorted by ' + labelForSort(query.sort));
    const head = 'Results';
    const text = parts.length ? (head+' for: ' + parts.join(' • ')) : head;
    summaryEl.innerHTML = '<strong>'+text+'</strong> <span aria-hidden="true">·</span> <span>'+count+' items</span>';
  }

  /* Apply / Reset */
  const applyBtn=panel.querySelector('[data-action="apply-filters"]');
  const resetBtn=panel.querySelector('[data-action="reset-filters"]');

  function triggerApply(closeToo=true){
    const query = collectQuery();
    const rows = filterRows(query);
    render(rows);
    panel.dispatchEvent(new CustomEvent('filters:apply',{detail:{query, count: rows.length},bubbles:true}));
    updateSummary(query, rows.length);
    if (closeToo && panel.classList.contains('is-open')) closeDrawer();
    console.log('filters:apply', query);
  }

  applyBtn?.addEventListener('click', ()=> triggerApply(true));

  resetBtn?.addEventListener('click', ()=>{
    $$('.filter-body input[type="checkbox"]',panel).forEach(i=> i.checked=false);
    $$('.filter-body input[type="radio"]',panel).forEach(i=> i.checked=(i.value==='')); /* radios -> Any */
    $$('.filter-body input[type="number"]',panel).forEach(i=> i.value='');
    chipsRow?.replaceChildren();
    panel.dispatchEvent(new CustomEvent('filters:reset',{bubbles:true}));
    panel.dispatchEvent(new CustomEvent('filters:change',{bubbles:true}));
    render(DATA);
    updateSummary({}, DATA.length);
  });

  sortSel?.addEventListener('change', ()=> triggerApply(false));

  let applyTimer=null;
  function debouncedApply(){ clearTimeout(applyTimer); applyTimer=setTimeout(()=>triggerApply(false),300); }

  /* Initial summary */
  updateSummary({}, DATA.length);
})();
</script>
</body>
</html>
