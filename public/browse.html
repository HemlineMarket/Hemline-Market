<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Browse — Hemline Market</title>
<style>
:root{--ink:#111827;--muted:#6b7280;--border:#e5e7eb;--accent:#991b1b;--bg:#fafafa}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  -webkit-font-smoothing:antialiased;
}
.is-hidden{display:none!important}

/* HEADER */
.hm-header{min-height:56px;background:#fff;border-bottom:1px solid var(--border)}
.hm-wrap{max-width:1200px;margin:0 auto;padding:0 12px;display:flex;align-items:center;justify-content:space-between}
.left{display:flex;align-items:center;gap:10px}
.hm-brand{font-size:24px;font-weight:800;color:var(--accent);text-decoration:none}
.hamburger{
  display:inline-grid;
  place-items:center;
  width:36px;
  height:36px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
  color:#374151;
}
.hamburger svg{width:22px;height:22px;stroke-width:2}
.right{display:flex;align-items:center;gap:14px}
.hm-icon{color:#444;display:inline-grid;place-items:center}
.hm-icon svg{width:26px;height:26px;stroke-width:2}
.hm-avatar{
  width:28px;
  height:28px;
  border-radius:50%;
  border:1px solid var(--border);
  background:#fff;
  color:#334155;
  display:inline-grid;
  place-items:center;
  font-weight:700;
  font-size:12px;
  text-decoration:none;
}
.hm-btn-primary{
  background:var(--accent);
  color:#fff;
  border:1px solid var(--accent);
  border-radius:999px;
  padding:10px 18px;
  font-weight:700;
  text-decoration:none;
  box-shadow:0 2px 8px rgba(153,27,27,.25);
}

/* FOOTER */
.hm-footer{background:#fff;border-top:1px solid var(--border)}
.footer-wrap{
  max-width:1200px;
  margin:0 auto;
  padding:10px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}
.footer-links{display:flex;gap:14px;flex-wrap:wrap}
.copy{color:#6b7280;font-size:14px}

/* SHEET */
.sheet{
  position:fixed;
  inset:0 auto 0 0;
  width:min(84vw,340px);
  background:#fff;
  border-right:1px solid var(--border);
  transform:translateX(-100%);
  transition:transform .25s ease;
  z-index:100;
  display:flex;
  flex-direction:column;
}
.sheet.open{transform:translateX(0)}
.sheet header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px;
  border-bottom:1px solid var(--border);
}
.sheet nav{display:grid;padding:10px}
.sheet nav a{
  padding:10px;
  border:1px solid var(--border);
  border-radius:10px;
  text-decoration:none;
  color:#1f2937;
}
.sheet nav a+a{margin-top:8px}
.sheet .close{
  display:inline-grid;
  place-items:center;
  width:30px;
  height:30px;
  border:1px solid var(--border);
  border-radius:8px;
  background:#fff;
  color:#444;
}

/* PAGE LAYOUT */
.wrap{max-width:1100px;margin:18px auto 28px;padding:0 12px}
.topbar{display:flex;gap:10px;align-items:center;margin-bottom:12px}
.topbar input[type="search"]{
  flex:1;
  padding:10px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
}
.topbar button{
  padding:9px 12px;
  border-radius:10px;
  border:1px solid var(--accent);
  background:var(--accent);
  color:#fff;
  font-weight:700;
}
.layout{display:grid;grid-template-columns:280px 1fr;gap:14px}
@media(max-width:900px){.layout{grid-template-columns:1fr}}

.filters{
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  height:max-content;
}
.filters h3{margin:0 0 8px}
.section{
  border-top:1px solid var(--border);
  padding-top:8px;
  margin-top:8px;
}
.section:first-of-type{
  border-top:0;
  padding-top:0;
  margin-top:0;
}
.title{
  font-weight:700;
  font-size:13px;
  color:#374151;
  margin:0 0 6px;
}
.listbox{
  max-height:230px;
  overflow:auto;
  border:1px solid var(--border);
  border-radius:10px;
  padding:6px;
  background:#fff;
}
.row{
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 4px;
  border-bottom:1px dashed #f3f4f6;
}
.row:last-child{border-bottom:0}
.row input{width:14px;height:14px}
.row label{font-size:12px;color:#374151}
.mini{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.mini .field{display:flex;flex-direction:column;gap:4px}
.mini label{font-size:12px;color:#374151}
.mini input{
  padding:7px 10px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
  font-size:13px;
  max-width:120px;
}
.selects{display:grid;gap:8px}
.selects select,.selects input{
  width:100%;
  padding:8px 10px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fff;
}

/* COLOR SWATCHES */
#colorBox{
  --sw:22px;
  --gap:6px;
  display:grid;
  grid-template-columns:repeat(5,var(--sw));
  grid-template-rows:repeat(3,var(--sw));
  gap:var(--gap);
  align-content:start;
  justify-content:start;
  padding:6px;
  background:#fff;
  border:1px solid var(--border);
  border-radius:10px;
}
#colorBox .sw{
  width:var(--sw);
  height:var(--sw);
  border-radius:6px;
  border:1px solid #d1d5db;
  box-shadow:inset 0 0 0 1px rgba(0,0,0,.06);
  cursor:pointer;
  position:relative;
}
#colorBox .sw[data-selected="true"]{outline:2px solid var(--accent);outline-offset:2px}
#colorBox .sw .tip{
  position:absolute;
  bottom:130%;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.85);
  color:#fff;
  padding:2px 5px;
  border-radius:4px;
  font-size:10px;
  white-space:nowrap;
  opacity:0;
  pointer-events:none;
}
#colorBox .sw:hover .tip{opacity:1}
#colorBox .sw[data-name="Gold"]{
  background:linear-gradient(135deg,#d4b870 0%,#f0dc97 50%,#ceb86b 100%);
}
#colorBox .sw[data-name="Silver"]{
  background:linear-gradient(135deg,#bfc6cf 0%,#e6eaef 50%,#a9b0ba 100%);
}

/* RESULTS */
.results{
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
  padding:12px;
  min-height:300px;
}
.results-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
.browse-grid{
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:12px;
}
@media(max-width:900px){
  .browse-grid{grid-template-columns:repeat(2,minmax(0,1fr))}
}
@media(max-width:560px){
  .browse-grid{grid-template-columns:1fr}
}
.card{
  display:block;
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;
  text-decoration:none;
  color:inherit;
}
.ph{
  aspect-ratio:4/3;
  display:grid;
  place-items:center;
  color:#6b7280;
  background:linear-gradient(180deg,#f8fafc,#eef2f7);
}
.meta{padding:8px 10px}
.meta .title{
  font-weight:800;
  margin-bottom:4px;
  line-height:1.2;
}
.meta .sub{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:space-between;
  font-size:13px;
  color:#6b7280;
}
.meta .sub span{white-space:nowrap}
.add-btn{
  width:100%;
  margin-top:10px;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid var(--accent);
  background:var(--accent);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}
</style>
</head>
<body>

<header class="hm-header" role="banner">
  <div class="hm-wrap">
    <div class="left">
      <button id="openMenu" class="hamburger" aria-label="Open menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" y1="6" x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
      <a class="hm-brand" href="index.html">Hemline Market</a>
    </div>
    <div class="right">
      <a class="hm-icon" href="browse.html" aria-label="Browse &amp; search">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="M21 21l-4.3-4.3"></path>
        </svg>
      </a>
      <a class="hm-icon" href="ThreadTalk.html" aria-label="ThreadTalk" title="ThreadTalk">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M4 6.5A4.5 4.5 0 0 1 8.5 2h7A4.5 4.5 0 0 1 20 6.5v5A4.5 4.5 0 0 1 15.5 16H12l-4 4v-4H8.5A4.5 4.5 0 0 1 4 11.5z"></path>
        </svg>
      </a>
      <a class="hm-icon" href="favorites.html" aria-label="Favorites">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
      </a>
      <a class="hm-icon" href="notifications.html" aria-label="Notifications">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M18 8a6 6 0 1 0-12 0c0 7-3 7-3 7h18s-3 0-3-7"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
      </a>
      <a class="hm-icon" href="cart.html" aria-label="Cart">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="18" cy="21" r="1"></circle>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
      </a>
      <!-- avatar stays simple here; localStorage can swap to a photo -->
      <a class="hm-avatar" id="avatar" href="account.html" title="Your profile">AA</a>
      <a class="hm-btn-primary" href="sell.html">Sell</a>
    </div>
  </div>
</header>

<aside class="sheet" id="menuSheet" aria-hidden="true">
  <header>
    <strong>Menu</strong>
    <button class="close" id="closeMenu" aria-label="Close menu">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </header>
  <nav>
    <a href="account.html">Account</a>
    <a href="atelier.html">My Atelier</a>
    <a href="how.html">How It Works</a>
    <a href="sell.html">Sell Fabric</a>
    <a href="ThreadTalk.html">ThreadTalk</a>
    <a href="contact.html">Contact</a>
  </nav>
</aside>

<main class="wrap">
  <div class="topbar">
    <input id="q" type="search" placeholder="Search fabrics…"/>
    <button id="doSearch">Search</button>
  </div>
  <div class="layout">
    <aside class="filters">
      <h3>Filters</h3>

      <section class="section">
        <div class="title">Content</div>
        <div class="listbox" id="contentBox"></div>
      </section>

      <section class="section">
        <div class="title">Color Family</div>
        <div id="colorBox"></div>
      </section>

      <section class="section">
        <div class="title">$/yard</div>
        <div class="mini">
          <div class="field">
            <label>Min</label>
            <input id="minPrice" type="number" min="0" step="1">
          </div>
          <div class="field">
            <label>Max</label>
            <input id="maxPrice" type="number" min="0" step="1">
          </div>
        </div>
      </section>

      <section class="section">
        <div class="title">Yards</div>
        <div class="mini">
          <div class="field" style="grid-column:1/-1">
            <label>Min yards</label>
            <input id="minYards" type="number" min="0" step="1">
          </div>
        </div>
      </section>

      <section class="section">
        <div class="title">Width (in)</div>
        <div class="mini">
          <div class="field">
            <label>Min</label>
            <input id="minWidth" type="number" min="0" step="1">
          </div>
          <div class="field">
            <label>Max</label>
            <input id="maxWidth" type="number" min="0" step="1">
          </div>
        </div>
      </section>

      <section class="section">
        <div class="title">Weight (GSM)</div>
        <div class="mini">
          <div class="field">
            <label>Min GSM</label>
            <input id="minGsm" type="number" min="0" step="1">
          </div>
          <div class="field">
            <label>Max GSM</label>
            <input id="maxGsm" type="number" min="0" step="1">
          </div>
        </div>
      </section>

      <section class="section">
        <div class="title">Department</div>
        <div class="selects">
          <select id="dept">
            <option value="">Any</option>
            <option>Fashion</option>
            <option>Home</option>
            <option>Quilting</option>
            <option>Notions</option>
          </select>
        </div>
      </section>

      <section class="section">
        <div class="title">Fabric Type</div>
        <div class="selects">
          <select id="fabricType">
            <option value="">Any</option>
            <option>Canvas</option>
            <option>Chiffon</option>
            <option>Corduroy</option>
            <option>Crepe</option>
            <option>Denim</option>
            <option>Flannel</option>
            <option>Georgette</option>
            <option>Jersey</option>
            <option>Lace</option>
            <option>Lawn</option>
            <option>Organza</option>
            <option>Poplin</option>
            <option>Sateen</option>
            <option>Satin</option>
            <option>Tulle</option>
            <option>Twill</option>
            <option>Velvet</option>
            <option>Voile</option>
          </select>
        </div>
      </section>

      <section class="section">
        <div class="title">Fiber Type</div>
        <div class="selects">
          <select id="fiberType">
            <option value="">Any</option>
            <option>Natural</option>
            <option>Modified Natural</option>
            <option>Synthetic</option>
            <option>Blend</option>
          </select>
        </div>
      </section>

      <section class="section">
        <div class="title">Designer / Mill</div>
        <div class="selects">
          <input id="designer" placeholder="e.g., Loro Piana"/>
        </div>
      </section>

      <section class="section">
        <div class="title">Country / Origin</div>
        <div class="selects">
          <select id="origin">
            <option value="">Any</option>
            <option>Italy</option>
            <option>France</option>
            <option>Japan</option>
            <option>UK</option>
            <option>USA</option>
            <option>India</option>
            <option>China</option>
            <option>Korea</option>
          </select>
        </div>
      </section>

      <section class="section">
        <div class="title">Pattern</div>
        <div class="selects">
          <select id="pattern">
            <option value="">Any</option>
            <option>Solid</option>
            <option>Printed</option>
          </select>
        </div>
      </section>
    </aside>

    <section class="results">
      <div class="results-head">
        <h2 style="margin:0;font-size:18px">Browse</h2>
        <div id="resultCount" style="color:#6b7280;font-size:13px">0 results</div>
      </div>
      <div id="grid" class="browse-grid"></div>
      <div id="empty" style="display:none;color:#6b7280">No results. Try relaxing a filter.</div>
    </section>
  </div>
</main>

<footer class="hm-footer" role="contentinfo">
  <div class="footer-wrap">
    <div class="copy">© 2025 Hemline Market</div>
    <nav class="footer-links" aria-label="Footer">
      <a href="about.html">About</a>
      <a href="faq.html">FAQ</a>
      <a href="contact.html">Contact</a>
      <a href="terms.html">Terms</a>
      <a href="privacy.html">Privacy</a>
    </nav>
  </div>
</footer>

<script>
/* Header + avatar (same pattern as other static pages) */
(function(){
  const s=document.getElementById("menuSheet"),
        o=document.getElementById("openMenu"),
        c=document.getElementById("closeMenu");
  function open(){s.classList.add("open");s.setAttribute("aria-hidden","false");}
  function close(){s.classList.remove("open");s.setAttribute("aria-hidden","true");}
  o&&o.addEventListener("click",e=>{e.preventDefault();open();});
  c&&c.addEventListener("click",e=>{e.preventDefault();close();});
  document.addEventListener("keydown",e=>{if(e.key==="Escape")close();});
  try{
    const a=document.getElementById("avatar"),
          u=localStorage.getItem("avatarUrl");
    if(u){a.textContent='';a.style.backgroundImage="url('"+u+"')";}
  }catch(_){}
})();

/* Demo data (includes seller info; price is per yard; yards is total lot size) */
const DATA=[
  {id:1,title:"Italian Silk Twill — Midnight",price:68,width:54,gsm:75,photo:"",content:["Silk"],color:"Blue",yards:8,dept:"Fashion",fabricType:"Twill",fiberType:"Natural",designer:"Ratti",origin:"Italy",pattern:"Solid",sellerId:"s_ratti",sellerName:"Ratti Fabrics"},
  {id:2,title:"Wool Crepe — Saffron",price:28,width:58,gsm:180,photo:"",content:["Wool"],color:"Yellow",yards:4,dept:"Fashion",fabricType:"Crepe",fiberType:"Natural",designer:"—",origin:"Italy",pattern:"Solid",sellerId:"s_folio",sellerName:"FabricFolio"},
  {id:3,title:"Cotton Poplin — Moss",price:14,width:44,gsm:120,photo:"",content:["Cotton"],color:"Green",yards:6,dept:"Fashion",fabricType:"Poplin",fiberType:"Natural",designer:"—",origin:"USA",pattern:"Solid",sellerId:"s_sew",sellerName:"SewSimple"}
];

/* Fiber content list — modeled after Mood-style content filter */
const CONTENTS=[
  "Any",
  "Acetate",
  "Acrylic",
  "Other Fibers",
  "Alpaca",
  "Aluminum",
  "Bamboo",
  "Bemberg",
  "Bemberg Viscose",
  "Camel Hair",
  "Cashmere",
  "Cotton",
  "Cotton Blend",
  "Cupro",
  "Eclon",
  "EcoTang Viscose",
  "Egyptian Cotton",
  "Elastane",
  "European Linen",
  "Hemp",
  "Lamb Skin",
  "Linen",
  "Lurex",
  "Lycra",
  "Lyocell",
  "Merino Wool",
  "Metal",
  "Modacrylic",
  "Modal",
  "Mohair",
  "Nylon",
  "Organic Cotton",
  "Pig Skin",
  "Pima Cotton",
  "Polyamide",
  "Polyester",
  "Polyethylene",
  "Polyurethane",
  "Polypropylene",
  "Polyvinyl Chloride",
  "Raffia",
  "Ramie",
  "Rayon",
  "Rayon Blend",
  "Recycled Cotton",
  "Recycled Nylon",
  "Recycled Polyester",
  "Recycled Spandex",
  "Recycled Viscose",
  "Rhinestone",
  "Sea Island Cotton",
  "Silk",
  "Silk Blend",
  "Spandex",
  "Tencel",
  "Terylene",
  "Triacetate",
  "Vinyl",
  "Virgin Wool",
  "Viscose",
  "Viscose EcoVero",
  "Wool",
  "Wool Blend"
];

/* Color family swatches — Mood-style */
const COLORS=[
  {name:"Black",hex:"#000"},
  {name:"Grey",hex:"#9aa0a6"},
  {name:"White",hex:"#fff",border:"#d1d5db"},
  {name:"Cream",hex:"#f5efe4"},
  {name:"Brown",hex:"#7a4a2a"},
  {name:"Pink",hex:"#f4a4b6"},
  {name:"Red",hex:"#d21d2b"},
  {name:"Orange",hex:"#f27a22"},
  {name:"Yellow",hex:"#f3c321"},
  {name:"Green",hex:"#2f7d32"},
  {name:"Blue",hex:"#2166d1"},
  {name:"Purple",hex:"#6b2da8"},
  {name:"Gold"},
  {name:"Silver"}
];

function el(t,c,txt){
  const n=document.createElement(t);
  if(c) n.className=c;
  if(txt!=null) n.textContent=txt;
  return n;
}

/* Build content + color filters */
(function buildFilters(){
  const box=document.getElementById('contentBox');
  box.innerHTML='';
  CONTENTS.forEach(v=>{
    const id='c_'+v.replace(/[^a-z0-9]/gi,'_'),
          row=el('div','row'),
          cb=el('input');
    cb.type='checkbox';
    cb.id=id;
    cb.value=v;
    const lb=el('label','',v);
    lb.htmlFor=id;
    row.append(cb,lb);
    box.append(row);
  });

  const colorBox=document.getElementById('colorBox');
  colorBox.innerHTML='';
  COLORS.forEach(c=>{
    const sw=el('div','sw');
    sw.dataset.name=c.name;
    sw.title=c.name;
    if(c.hex) sw.style.background=c.hex;
    if(c.border) sw.style.borderColor=c.border;
    sw.append(el('span','tip',c.name));
    colorBox.append(sw);
  });
})();

/* State + events */
const state={
  q:'',
  content:new Set(),
  colors:new Set(),
  minPrice:'',
  maxPrice:'',
  minYards:'',
  minWidth:'',
  maxWidth:'',
  minGsm:'',
  maxGsm:'',
  dept:'',
  fabricType:'',
  fiberType:'',
  designer:'',
  origin:'',
  pattern:''
};

document.getElementById('doSearch').onclick=()=>{
  state.q=document.getElementById('q').value.trim().toLowerCase();
  render();
};

document.getElementById('contentBox').addEventListener('change',e=>{
  if(e.target.type==='checkbox'){
    if(e.target.checked){
      if(e.target.value!=='Any') state.content.add(e.target.value);
    }else{
      state.content.delete(e.target.value);
    }
    render();
  }
});

document.getElementById('colorBox').addEventListener('click',e=>{
  const sw=e.target.closest('.sw'); if(!sw) return;
  const name=sw.dataset.name;
  if(sw.dataset.selected){
    sw.removeAttribute('data-selected');
    state.colors.delete(name);
  }else{
    sw.dataset.selected='true';
    state.colors.add(name);
  }
  render();
});

[
  'minPrice','maxPrice','minYards','minWidth','maxWidth',
  'minGsm','maxGsm','dept','fabricType','fiberType',
  'designer','origin','pattern'
].forEach(id=>{
  const elDom=document.getElementById(id);
  elDom.addEventListener('input',()=>{
    state[id]=elDom.value.trim();
    render();
  });
  if(elDom.tagName==='SELECT'){
    elDom.addEventListener('change',()=>{
      state[id]=elDom.value.trim();
      render();
    });
  }
});

/* Filtering + render */
function n(v){return v===''?null:Number(v);}

function pass(it){
  if(state.q && !(`${it.title} ${it.designer||''}`.toLowerCase().includes(state.q))) return false;

  if(state.content.size){
    const lc=it.content.map(s=>s.toLowerCase());
    const has=[...state.content].some(c=>lc.includes(c.toLowerCase()));
    if(!has) return false;
  }

  if(state.colors.size && !state.colors.has(it.color)) return false;
  if(n(state.minPrice)!=null && it.price<n(state.minPrice)) return false;
  if(n(state.maxPrice)!=null && it.price>n(state.maxPrice)) return false;
  if(n(state.minYards)!=null && it.yards<n(state.minYards)) return false;
  if(n(state.minWidth)!=null && it.width<n(state.minWidth)) return false;
  if(n(state.maxWidth)!=null && it.width>n(state.maxWidth)) return false;
  if(n(state.minGsm)!=null && it.gsm<n(state.minGsm)) return false;
  if(n(state.maxGsm)!=null && it.gsm>n(state.maxGsm)) return false;
  if(state.dept && it.dept!==state.dept) return false;
  if(state.fabricType && it.fabricType!==state.fabricType) return false;
  if(state.fiberType && it.fiberType!==state.fiberType) return false;
  if(state.designer && !(it.designer||'').toLowerCase().includes(state.designer.toLowerCase())) return false;
  if(state.origin && it.origin!==state.origin) return false;
  if(state.pattern && it.pattern!==state.pattern) return false;
  return true;
}

function cents(x){return Math.round(Number(x||0)*100);}

function makeCard(it){
  const a=el('a','card');
  a.href='listing.html?id='+encodeURIComponent(it.id);
  a.dataset.id=it.id;

  const ph=el('div','ph',it.photo?'':it.title);
  if(it.photo){
    const img=new Image();
    img.src=it.photo;
    img.alt=it.title;
    ph.append(img);
  }

  const meta=el('div','meta');
  const t=el('div','title',it.title);
  const sub=el('div','sub');
  sub.append(
    el('span','',`$${it.price}/yd`),
    el('span','',`${it.width}″ • ${it.gsm} GSM • ${it.yards} yd lot`)
  );

  const total=(Number(it.price)||0)*(Number(it.yards)||0);
  const amountCents=cents(total);

  const btn=el('button','add-btn add-to-cart',`Add to Cart — $${total.toFixed(2)}`);
  btn.type='button';
  btn.dataset.name = it.title;
  btn.dataset.amount = String(amountCents);
  btn.dataset.yards  = String(it.yards);
  btn.dataset.price  = String(it.price);
  btn.dataset.sellerId   = it.sellerId || ('seller_'+it.id);
  btn.dataset.sellerName = it.sellerName || 'Seller';

  meta.append(t,sub,btn);
  a.append(ph,meta);
  return a;
}

function render(){
  const grid=document.getElementById('grid'),
        empty=document.getElementById('empty');
  const list=DATA.filter(pass);
  document.getElementById('resultCount').textContent =
    list.length + (list.length===1 ? ' result' : ' results');
  grid.innerHTML='';
  if(!list.length){
    empty.style.display='block';
    return;
  }
  empty.style.display='none';
  list.forEach(it=>grid.append(makeCard(it)));
}

render();
</script>
<script src="assets/add-to-cart.js" defer></script>
</body>
</html>
