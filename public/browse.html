<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hemline Market â€” Browse</title>

  <!-- IMPORTANT: This page is self-contained and won't alter global styles. -->
  <style>
    /* =============================
       Scoped styles: .hm-browse only
       ============================= */
    .hm-browse { background:#fff; color:#111; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; }
    .hm-browse a { text-decoration: none; }
    .hm-browse .wrap { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .hm-browse .visually-hidden { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }

    /* Header/Footer placeholders â€“ minimal so your site CSS can style your pasted header/footer */
    .hm-browse header, .hm-browse footer { width:100%; }

    /* Filters bar (restored baseline layout; sections in one row, wrapping) */
    .hm-browse .filters-bar {
      border-top:1px solid #e5e7eb; border-bottom:1px solid #e5e7eb; background:#fafafa;
    }
    .hm-browse .filters-inner {
      display:flex; gap:12px; flex-wrap:wrap; align-items:center; padding:12px 0;
    }
    .hm-browse .filter {
      display:flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid #e5e7eb; border-radius:999px; background:#fff;
      line-height:1; font-size:14px;
    }
    .hm-browse .filter button.filter-toggle {
      border:0; background:transparent; cursor:pointer; font-size:16px; line-height:1; width:20px; height:20px;
    }
    .hm-browse .filter .label { font-weight:600; color:#111; }
    .hm-browse .filter-panel {
      display:none; position:absolute; z-index:10; background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px; margin-top:6px; box-shadow:0 8px 24px rgba(0,0,0,0.08);
    }
    .hm-browse .filter-group { position:relative; }
    .hm-browse .filter-options { display:flex; gap:8px; flex-wrap:wrap; max-width:580px; }
    .hm-browse .chip {
      display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid #e5e7eb; border-radius:999px; background:#fff; cursor:pointer; font-size:13px;
    }
    .hm-browse .chip[data-selected="true"] { border-color:#111; }

    /* Icons (heart/bell) as buttons, not links, so they never turn purple/visited */
    .hm-browse .actions { display:flex; gap:10px; margin-left:auto; }
    .hm-browse .icon-btn {
      border:1px solid #e5e7eb; background:#fff; padding:8px 10px; border-radius:999px; cursor:pointer; font-size:14px;
    }
    .hm-browse .icon-btn:focus-visible { outline:2px solid #111; outline-offset:2px; }

    /* Results grid placeholder */
    .hm-browse .results { padding:18px 0 40px; }
    .hm-browse .grid { display:grid; grid-template-columns: repeat(4, 1fr); gap:16px; }
    @media (max-width: 1000px){ .hm-browse .grid { grid-template-columns: repeat(3, 1fr);} }
    @media (max-width: 700px){ .hm-browse .grid { grid-template-columns: repeat(2, 1fr);} }

    .hm-browse .card { border:1px solid #e5e7eb; border-radius:12px; overflow:hidden; background:#fff; }
    .hm-browse .ph { aspect-ratio: 4/3; background:#f3f4f6; }
    .hm-browse .card .meta { padding:10px; font-size:14px; display:flex; justify-content:space-between; gap:8px; }
  </style>
</head>
<body class="hm-browse">

  <!-- ========= HEADER =========
       Paste your APPROVED homepage header markup between these comments
       to guarantee pixel-identical header across pages. -->
  <header id="site-header">
    <!-- PASTE APPROVED HEADER HERE -->
  </header>
  <!-- ======== /HEADER ========= -->

  <main>
    <section class="wrap" aria-label="Browse">
      <!-- Top row: actions + (optional) search summary -->
      <div class="filters-bar">
        <div class="filters-inner">
          <!-- Filters you loved: restored as discrete groups with + toggles -->
          <div class="actions">
            <button class="icon-btn" type="button" id="favBtn" aria-label="Favorites">â™¥</button>
            <button class="icon-btn" type="button" id="alertBtn" aria-label="Alerts">ðŸ””</button>
          </div>

          <!-- Filter groups -->
          <div class="filter-group" data-key="width">
            <div class="filter"><span class="label">Width</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-width">+</button></div>
            <div class="filter-panel" id="panel-width">
              <div class="filter-options" data-options="width">
                <button class="chip" data-value="36in">36"</button>
                <button class="chip" data-value="44in">44"</button>
                <button class="chip" data-value="54in">54"</button>
                <button class="chip" data-value="60in">60"</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="weight">
            <div class="filter"><span class="label">Weight</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-weight">+</button></div>
            <div class="filter-panel" id="panel-weight">
              <div class="filter-options" data-options="weight">
                <button class="chip" data-value="light">Light</button>
                <button class="chip" data-value="midweight">Midweight</button>
                <button class="chip" data-value="heavy">Heavy</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="department">
            <div class="filter"><span class="label">Department</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-department">+</button></div>
            <div class="filter-panel" id="panel-department">
              <div class="filter-options" data-options="department">
                <button class="chip" data-value="apparel">Apparel</button>
                <button class="chip" data-value="home">Home</button>
                <button class="chip" data-value="accessories">Accessories</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="fiber">
            <div class="filter"><span class="label">Fiber Type</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-fiber">+</button></div>
            <div class="filter-panel" id="panel-fiber">
              <div class="filter-options" data-options="fiber">
                <button class="chip" data-value="cashmere">Cashmere</button>
                <button class="chip" data-value="wool">Wool</button>
                <button class="chip" data-value="silk">Silk</button>
                <button class="chip" data-value="cotton">Cotton</button>
                <button class="chip" data-value="linen">Linen</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="designer">
            <div class="filter"><span class="label">Designer</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-designer">+</button></div>
            <div class="filter-panel" id="panel-designer">
              <div class="filter-options" data-options="designer">
                <button class="chip" data-value="atelier">Atelier</button>
                <button class="chip" data-value="indie">Indie</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="country">
            <div class="filter"><span class="label">Country</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-country">+</button></div>
            <div class="filter-panel" id="panel-country">
              <div class="filter-options" data-options="country">
                <button class="chip" data-value="italy">Italy</button>
                <button class="chip" data-value="france">France</button>
                <button class="chip" data-value="japan">Japan</button>
                <button class="chip" data-value="usa">USA</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="pattern">
            <div class="filter"><span class="label">Pattern</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-pattern">+</button></div>
            <div class="filter-panel" id="panel-pattern">
              <div class="filter-options" data-options="pattern">
                <button class="chip" data-value="solid">Solid</button>
                <button class="chip" data-value="stripe">Stripe</button>
                <button class="chip" data-value="check">Check</button>
                <button class="chip" data-value="floral">Floral</button>
              </div>
            </div>
          </div>

          <div class="filter-group" data-key="type">
            <div class="filter"><span class="label">Fabric Type</span><button class="filter-toggle" aria-expanded="false" aria-controls="panel-type">+</button></div>
            <div class="filter-panel" id="panel-type">
              <div class="filter-options" data-options="type">
                <button class="chip" data-value="suiting">Suiting</button>
                <button class="chip" data-value="twill">Twill</button>
                <button class="chip" data-value="jersey">Jersey</button>
                <button class="chip" data-value="crepe">Crepe</button>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- Active filters summary (auto-populated) -->
      <div id="activeSummary" class="visually-hidden" aria-live="polite"></div>

      <!-- Results -->
      <div class="results">
        <div class="grid" id="resultsGrid" aria-label="Results">
          <!-- Placeholder cards -->
          <article class="card"><div class="ph"></div><div class="meta"><span>Fabric #1</span><span>$â€”</span></div></article>
          <article class="card"><div class="ph"></div><div class="meta"><span>Fabric #2</span><span>$â€”</span></div></article>
          <article class="card"><div class="ph"></div><div class="meta"><span>Fabric #3</span><span>$â€”</span></div></article>
          <article class="card"><div class="ph"></div><div class="meta"><span>Fabric #4</span><span>$â€”</span></div></article>
        </div>
      </div>
    </section>
  </main>

  <!-- ========= FOOTER =========
       Paste your APPROVED homepage footer markup between these comments
       to guarantee pixel-identical footer across pages. -->
  <footer id="site-footer">
    <!-- PASTE APPROVED FOOTER HERE -->
  </footer>
  <!-- ======== /FOOTER ========= -->

  <script>
    (function(){
      // ---- Utility: parse query string
      const params = new URLSearchParams(window.location.search);

      // Standard keys we agreed to
      const keys = ["width","weight","department","fiber","designer","country","pattern","type","q","search","tag","fabric","category"];

      // Map generic keys/fallbacks â†’ standardized keys
      const normalize = (k, v) => {
        const val = (v||"").toLowerCase();
        if (k === "q" || k === "search" || k === "tag" || k === "fabric" || k === "category") {
          // Try to resolve known vocabulary to specific groups
          const fiberVocab = ["cashmere","wool","silk","cotton","linen","alpaca","mohair"];
          if (fiberVocab.includes(val)) return ["fiber", val];
          // Add more vocab maps later if needed
          return ["q", v];
        }
        return [k, v];
      };

      // Apply preselection from query string
      const selections = {};
      keys.forEach(k => {
        if (params.has(k)) {
          const [nk, nv] = normalize(k, params.get(k));
          if (nv) selections[nk] = nv.toLowerCase();
        }
      });

      // Hook up filter toggles
      document.querySelectorAll(".hm-browse .filter-group").forEach(group => {
        const btn = group.querySelector(".filter-toggle");
        const panel = group.querySelector(".filter-panel");
        if (!btn || !panel) return;
        btn.addEventListener("click", () => {
          const open = panel.style.display === "block";
          panel.style.display = open ? "none" : "block";
          btn.setAttribute("aria-expanded", String(!open));
        });
        // Close when clicking outside
        document.addEventListener("click", (e) => {
          if (!group.contains(e.target)) {
            panel.style.display = "none";
            btn.setAttribute("aria-expanded", "false");
          }
        });
      });

      // Select/deselect chips
      document.querySelectorAll(".hm-browse .chip").forEach(chip => {
        chip.addEventListener("click", () => {
          const was = chip.getAttribute("data-selected") === "true";
          // Single-select per group
          const group = chip.closest(".filter-panel");
          group.querySelectorAll(".chip").forEach(c => c.setAttribute("data-selected","false"));
          chip.setAttribute("data-selected", was ? "false" : "true");
          updateSummary();
        });
      });

      // Apply initial selections (from URL)
      Object.entries(selections).forEach(([k, v]) => {
        const panel = document.querySelector(`.hm-browse .filter-panel[id="panel-${k}"]`);
        if (!panel) return;
        const target = Array.from(panel.querySelectorAll(".chip")).find(c => (c.dataset.value||"").toLowerCase() === v);
        if (target) {
          // open briefly to ensure layout positions, then mark selected
          target.setAttribute("data-selected","true");
          // optional: open the panel to show the applied filter
          const toggle = panel.parentElement.querySelector(".filter-toggle");
          if (toggle) { panel.style.display = "block"; toggle.setAttribute("aria-expanded","true"); }
        }
      });

      function updateSummary(){
        const active = [];
        document.querySelectorAll('.hm-browse .filter-group').forEach(group => {
          const key = group.getAttribute('data-key');
          const sel = group.querySelector('.chip[data-selected="true"]');
          if (sel) active.push(`${key}: ${sel.textContent.trim()}`);
        });
        const summary = document.getElementById("activeSummary");
        if (active.length) {
          summary.textContent = `Active filters â€” ${active.join(" â€¢ ")}`;
          summary.classList.remove("visually-hidden");
        } else {
          summary.textContent = "";
          summary.classList.add("visually-hidden");
        }
      }

      updateSummary();

      // Heart/Bell are buttons (no visited link color)
      document.getElementById("favBtn")?.addEventListener("click", ()=>{ /* TODO: hook to favorites */ });
      document.getElementById("alertBtn")?.addEventListener("click", ()=>{ /* TODO: hook to alerts */ });
    })();
  </script>
</body>
</html>
