<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact • Hemline Market</title>
  <style>
    :root { --bg:#fff; --ink:#111; --muted:#666; --line:#eaeaea; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:var(--ink); background:var(--bg); }
    .wrap { max-width: 720px; margin: 48px auto; padding: 0 16px; }
    h1 { font-size: 28px; margin: 0 0 8px; }
    p.lead { color: var(--muted); margin: 0 0 24px; }
    form { display: grid; gap: 16px; border-top: 1px solid var(--line); padding-top: 16px; }
    label { font-weight: 600; }
    input, textarea { width: 100%; box-sizing: border-box; padding: 12px 14px; border:1px solid var(--line); border-radius: 10px; font-size: 16px; }
    textarea { min-height: 140px; resize: vertical; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .actions { display: flex; gap: 12px; align-items: center; }
    button { padding: 12px 16px; border:0; border-radius: 12px; font-weight: 700; cursor: pointer; background:#111; color:#fff; }
    button[disabled] { opacity:.6; cursor: not-allowed; }
    .msg { font-size: 14px; }
    .ok { color: #0a7a28; }
    .err { color: #b00020; }
    /* Hide honeypot field from humans */
    .hp { position: absolute; left: -10000px; top: -10000px; height: 0; width: 0; overflow: hidden; }
  </style>
</head>
<body>
  <main class="wrap">
    <h1>Contact Hemline Market</h1>
    <p class="lead">Questions, ideas, or feedback? Send us a note — we read every message.</p>

    <form id="contactForm" novalidate>
      <div class="row">
        <div>
          <label for="name">Your name</label>
          <input id="name" name="name" type="text" placeholder="Afroza" autocomplete="name" required />
        </div>
        <div>
          <label for="email">Your email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" autocomplete="email" required />
        </div>
      </div>

      <div>
        <label for="message">Message</label>
        <textarea id="message" name="message" placeholder="Write your message..." required></textarea>
      </div>

      <!-- Honeypot (simple spam trap) -->
      <div class="hp" aria-hidden="true">
        <label for="company">Company</label>
        <input id="company" name="company" type="text" tabindex="-1" autocomplete="off" />
      </div>

      <div class="actions">
        <button id="sendBtn" type="submit">Send message</button>
        <span id="status" class="msg" role="status" aria-live="polite"></span>
      </div>
    </form>
  </main>

  <script>
    (function() {
      const form = document.getElementById('contactForm');
      const status = document.getElementById('status');
      const btn = document.getElementById('sendBtn');

      function looksLikeEmail(s) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(s || ''));
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        status.textContent = '';
        status.className = 'msg';

        const name = form.name.value.trim();
        const email = form.email.value.trim();
        const message = form.message.value.trim();
        const honeypot = form.company.value.trim(); // hidden field

        // Quick client-side checks
        if (!name || !email || !message) {
          status.textContent = 'Please fill in all required fields.';
          status.className = 'msg err';
          return;
        }
        if (!looksLikeEmail(email)) {
          status.textContent = 'Please enter a valid email address.';
          status.className = 'msg err';
          return;
        }

        btn.disabled = true;
        btn.textContent = 'Sending…';

        try {
          const r = await fetch('/api/contact', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, email, message, honeypot })
          });

          const data = await r.json().catch(() => ({}));

          if (r.ok && data && data.ok) {
            form.reset();
            status.textContent = 'Message sent! We’ll get back to you at hello@hemlinemarket.com.';
            status.className = 'msg ok';
          } else {
            const reason = (data && (data.error || data.detail)) ? (' — ' + JSON.stringify(data)) : '';
            status.textContent = 'Couldn’t send right now' + reason;
            status.className = 'msg err';
          }
        } catch (err) {
          status.textContent = 'Network error — please try again.';
          status.className = 'msg err';
        } finally {
          btn.disabled = false;
          btn.textContent = 'Send message';
        }
      });
    })();
  </script>
</body>
</html>
