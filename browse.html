<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Browse · Hemline Market</title>
  <link rel="stylesheet" href="styles/hm-modern.css" />
  <link rel="stylesheet" href="styles/hem-header.css" />
  <link rel="stylesheet" href="styles/hm-filters.css" />
</head>
<body>
  <!-- GLOBAL HEADER -->
  <header class="hm-header" role="banner">
    <div class="wrap">
      <div class="left">
        <a class="hm-brand" href="index.html" aria-label="Hemline Market home">
          Hemline<span class="dot">•</span>Market
        </a>
        <nav class="hm-nav" aria-label="Primary">
          <a href="browse.html" aria-current="page">Browse</a>
          <a href="about.html">About</a>
        </nav>
      </div>

      <div class="hm-search">
        <form action="browse.html" method="get" role="search" aria-label="Sitewide">
          <input type="search" name="q" placeholder="Search fabrics, shops, or styles…" />
          <button type="submit" aria-label="Search">Search</button>
        </form>
      </div>

      <div class="hm-actions">
        <a class="hm-icon" href="favorites.html" aria-label="Favorites">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
        </a>
        <a class="hm-btn hm-btn-primary" href="seller/index.html?list=new" aria-label="List an item">
          <span class="label">List Item</span>
        </a>
        <a class="hm-avatar" href="account.html" aria-label="Your profile">?</a>
      </div>
    </div>
  </header>

  <!-- BROWSE LAYOUT -->
  <div class="hm-browse-grid">
    <!-- Filters -->
    <aside class="hm-filters" aria-label="Filters">
      <header>Filters</header>
      <form id="filters" action="browse.html" method="get">
        <!-- Preserve search query from header if present -->
        <input type="hidden" name="q" id="filter-q" value="">

        <section class="hm-filter">
          <details>
            <summary>Fiber</summary>
            <div class="body">
              <div class="stack">
                <label><input type="checkbox" name="fiber_wool" value="1"> Wool</label>
                <label><input type="checkbox" name="fiber_silk" value="1"> Silk</label>
                <label><input type="checkbox" name="fiber_cotton" value="1"> Cotton</label>
                <label><input type="checkbox" name="fiber_linen" value="1"> Linen</label>
                <label><input type="checkbox" name="fiber_blend" value="1"> Blend</label>
              </div>
            </div>
          </details>
        </section>

        <section class="hm-filter">
          <details>
            <summary>Weight</summary>
            <div class="body">
              <div class="stack">
                <label><input type="checkbox" name="wt_light" value="1"> Light</label>
                <label><input type="checkbox" name="wt_mid" value="1"> Mid</label>
                <label><input type="checkbox" name="wt_heavy" value="1"> Heavy</label>
              </div>
            </div>
          </details>
        </section>

        <section class="hm-filter">
          <details>
            <summary>Color</summary>
            <div class="body">
              <div class="stack">
                <label><input type="checkbox" name="clr_neutral" value="1"> Neutrals</label>
                <label><input type="checkbox" name="clr_red" value="1"> Red</label>
                <label><input type="checkbox" name="clr_blue" value="1"> Blue</label>
                <label><input type="checkbox" name="clr_green" value="1"> Green</label>
                <label><input type="checkbox" name="clr_black" value="1"> Black</label>
                <label><input type="checkbox" name="clr_white" value="1"> White</label>
              </div>
            </div>
          </details>
        </section>

        <section class="hm-filter">
          <details>
            <summary>Price</summary>
            <div class="body">
              <div class="range">
                <input type="number" inputmode="numeric" name="price_min" placeholder="Min">
                <span class="dash">–</span>
                <input type="number" inputmode="numeric" name="price_max" placeholder="Max">
              </div>
              <div class="help">USD per yard (or listing).</div>
            </div>
          </details>
        </section>

        <div class="hm-filter">
          <div class="body">
            <div class="actions">
              <button class="btn btn-primary" type="submit">Apply</button>
              <a class="btn" href="browse.html">Clear</a>
            </div>
          </div>
        </div>
      </form>
    </aside>

    <!-- Results shell -->
    <main class="hm-results">
      <h1 style="margin:0 0 10px 0;">Browse</h1>
      <div class="active-filters" id="active-filters"></div>
      <div class="hm-grid" id="results-grid">
        <!-- Temporary placeholder cards -->
        <div class="hm-card">Result A</div>
        <div class="hm-card">Result B</div>
        <div class="hm-card">Result C</div>
      </div>
      <div class="hm-empty" id="empty" style="display:none;">No results. Try removing some filters.</div>
    </main>
  </div>

  <!-- Minimal hydration to reflect active filters and preserve q -->
  <script>
    (function(){
      const qs = new URLSearchParams(location.search);
      const form = document.getElementById('filters');

      // Preserve header search query inside the filters form
      const qHidden = document.getElementById('filter-q');
      qHidden.value = qs.get('q') || '';

      // Re-check controls from query string
      form.querySelectorAll('input').forEach(inp=>{
        const k = inp.name, v = qs.get(k);
        if(!v) return;
        if(inp.type === 'checkbox' || inp.type === 'radio'){
          inp.checked = (v === '1' || v === inp.value);
        } else {
          inp.value = v;
        }
        // open its <details> if something is active
        const det = inp.closest('details');
        if(det) det.open = true;
      });

      // Render simple "Active filters" chips
      const mapLabels = {
        fiber_wool:'Wool', fiber_silk:'Silk', fiber_cotton:'Cotton', fiber_linen:'Linen', fiber_blend:'Blend',
        wt_light:'Light', wt_mid:'Mid', wt_heavy:'Heavy',
        clr_neutral:'Neutrals', clr_red:'Red', clr_blue:'Blue', clr_green:'Green', clr_black:'Black', clr_white:'White'
      };
      const chips = [];
      Object.entries(mapLabels).forEach(([key,label])=>{
        if(qs.get(key)) chips.push(label);
      });
      const pmin = qs.get('price_min'), pmax = qs.get('price_max');
      if(pmin || pmax){ chips.push(`$${pmin||'0'}–$${pmax||'∞'}`); }
      const q = qs.get('q'); if(q){ chips.unshift(`“${q}”`); }
      const af = document.getElementById('active-filters');
      if(chips.length){ chips.forEach(t=>{
        const el = document.createElement('span'); el.className='hm-chip'; el.textContent=t; af.appendChild(el);
      }); }

      // Fake "no results" demo if filters present but no cards exist (for UX check)
      const hasFilters = Array.from(qs.keys()).some(k=>k.startsWith('fiber_')||k.startsWith('wt_')||k.startsWith('clr_')||k.startsWith('price_'));
      if(hasFilters === true){
        // leave the placeholder cards visible for now; real data will replace later
      }
    })();
  </script>
</body>
</html>
